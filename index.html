<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
   <meta charset="UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ | El Jasus</title>
    <meta name="description" content="Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ - Ø§Ù„Ø¹Ø¨ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙˆØ§ÙƒØªØ´Ù Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø¨ÙŠÙ†ÙƒÙ… ÙÙŠ Ø£Ø¬ÙˆØ§Ø¡ Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠ ÙˆØ§Ù„Ø°ÙƒØ§Ø¡!">
    <meta name="keywords" content="Ø§Ù„Ø¬Ø§Ø³ÙˆØ³, Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¬Ø§Ø³ÙˆØ³, Ø£Ù„Ø¹Ø§Ø¨ Ø¬Ù…Ø§Ø¹ÙŠØ©, Ø£Ù„Ø¹Ø§Ø¨ Ø­ÙÙ„Ø§Øª, Ø£Ù„Ø¹Ø§Ø¨ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†, Ø£Ù„Ø¹Ø§Ø¨ Ù…Ø­Ù„ÙŠØ©, ØªØ±ÙÙŠÙ‡, ØªØ³Ù„ÙŠØ©, ØªØ­Ø¯ÙŠ, ÙƒÙ„Ù…Ø§Øª Ø³Ø±ÙŠØ©, PhineX">
    <meta name="author" content="PhineX">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://el-jasus.web.app/">
    <meta property="og:title" content="Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ | El Jasus">
    <meta property="og:description" content="Ø§ÙƒØªØ´Ù Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø¨ÙŠÙ†ÙƒÙ…! Ù„Ø¹Ø¨Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© Ù…Ù…ØªØ¹Ø© Ù„Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ù…ØªÙˆÙØ±Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ÙˆÙ…Ø­Ù„ÙŠØ§Ù‹.">
    <meta property="og:site_name" content="El Jasus">
    <meta property="og:locale" content="ar_EG">
    <title>Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ | El Jasus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="ElJasus2.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { 
            --bg-color: #080808;
            --card-color: rgba(20, 20, 20, 0.9);
            --btn-color: #00f2ff;
            --text-color: #ffffff;
            --accent-color: #00f2ff;
        }
        
        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            min-height: 100vh; 
            transition: background 0.3s ease;
        }
        
        .glass { 
            background: var(--card-color); 
            backdrop-filter: blur(15px); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
        }
        
        .dynamic-text-primary { color: var(--accent-color); }
        .dynamic-border-primary { border-color: var(--accent-color); }
        .dynamic-bg-primary { background-color: var(--btn-color); color: var(--bg-color); }
        
        .btn-main { 
            background-color: var(--btn-color); 
            color: var(--bg-color); 
            font-weight: 900; 
            transition: 0.3s; 
        }
        .btn-main:hover { transform: scale(1.02); filter: brightness(1.2); }

        .reveal-innocent {
            background: linear-gradient(145deg, #065f46, #059669) !important;
            border-color: #34d399 !important;
            box-shadow: 0 0 30px rgba(52, 211, 153, 0.3);
            animation: flipInY 0.6s;
        }

        .reveal-spy {
            background: linear-gradient(145deg, #7f1d1d, #dc2626) !important;
            border-color: #f87171 !important;
            box-shadow: 0 0 30px rgba(248, 113, 113, 0.3);
            animation: shakeX 0.5s;
        }

        :root {
    --primary-color: #7c30ff;
    --bg-sidebar: #1a1a1a;
    --text-main: #ffffff;
}

/* Specific Crown Styling */
.fa-crown {
    color: #ffd700;
    filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7));
    animation: royal-pulse 2s infinite ease-in-out;
}

@keyframes royal-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

/* Styling for Admin Tags */
.admin-tag {
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 4px;
    margin-left: 5px;
    text-transform: uppercase;
    font-weight: 800;
    letter-spacing: 0.5px;
    vertical-align: middle;
    display: inline-block;
}

/* Owner Tag: Golden Glow */
.owner-tag {
    background: rgba(255, 215, 0, 0.2);
    color: #ffd700;
    border: 1px solid rgba(255, 215, 0, 0.5);
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
}

/* Developer Tag: Blue Glow */
.dev-tag {
    background: rgba(96, 165, 250, 0.2);
    color: #60a5fa;
    border: 1px solid rgba(96, 165, 250, 0.5);
    box-shadow: 0 0 10px rgba(96, 165, 250, 0.2);
}

.fa-laptop-code {
    color: #60a5fa; /* Developer Blue */
}

/* Animated Infinity Border */
.infinity-border {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    width: 2px;
    background: linear-gradient(to bottom, transparent, #7c30ff, #fff, #7c30ff, transparent);
    background-size: 100% 200%;
    animation: infinity-flow 3s linear infinite;
}

@keyframes infinity-flow {
    0% { background-position: 0% 0%; }
    100% { background-position: 0% 200%; }
}

/* Gradient Text Animation */
@keyframes gradient-text {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.animate-gradient-text {
    animation: gradient-text 3s ease infinite;
}

/* Hover effect for Links */
.nav-link-anime {
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

.nav-link-anime::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -100%;
    width: 100%;
    height: 2px;
    background: #7c30ff;
    transition: left 0.3s ease;
}

.nav-link-anime:hover {
    background: rgba(124, 48, 255, 0.1);
    color: #7c30ff;
}

.nav-link-anime:hover::after {
    left: 0;
}

/* Special glow for the How to Play icon in Sidebar */
.fa-book-open{
    filter: drop-shadow(0 0 5px rgba(0, 242, 255, 0.4));
}

.nav-link-anime:hover .fa-book-open {
    filter: drop-shadow(0 0 10px rgba(0, 242, 255, 0.8));
    transform: rotate(-10deg);
    transition: all 0.3s ease;
}

/* Logout Button Glow */
.logout-btn-anime:hover {
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
    transform: scale(1.02);
}

/* --- Icon Animations --- */
        @keyframes book-flip {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(-40deg) scale(1.1); }
        }
        .animate-book { animation: book-flip 2s infinite ease-in-out; }

        @keyframes house-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .animate-house { animation: house-bounce 2.5s infinite ease-in-out; }

        @keyframes user-pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-user { animation: user-pulse 3s infinite; }

        @keyframes spy-peek {
            0%, 100% { transform: translateY(0) rotate(0); }
            25% { transform: translateY(-3px) rotate(5deg); }
            75% { transform: translateY(2px) rotate(-5deg); }
        }
        .animate-spy { animation: spy-peek 4s infinite ease-in-out; }

        @keyframes dragon-glow {
            0%, 100% { filter: drop-shadow(0 0 5px var(--primary-color)); }
            50% { filter: drop-shadow(0 0 15px var(--primary-color)); transform: scale(1.05); }
        }
        .animate-dragon { animation: dragon-glow 3s infinite; }

        /* --- UI Components --- */
        .infinity-border {
            position: absolute;
            top: 0; right: 0; bottom: 0; width: 2px;
            background: linear-gradient(to bottom, transparent, var(--primary-color), #fff, var(--primary-color), transparent);
            background-size: 100% 200%;
            animation: flow 3s linear infinite;
        }
        @keyframes flow { 0% { background-position: 0% 0%; } 100% { background-position: 0% 200%; } }

        .glass-card {
            background: var(--card-color);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(124, 48, 255, 0.2);
            color: var(--text-main);
        }

        .card-entrance {
            animation: cardIn 0.5s cubic-bezier(0.23, 1, 0.32, 1) forwards;
        }
        @keyframes cardIn {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .animate-gradient-text {
            background: linear-gradient(to right, #fff, var(--primary-color), #00f2ff, #fff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 4s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }

        .role-toggle-btn {
            padding: 12px 28px;
            border-radius: 20px;
            font-weight: 900;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.4s ease;
        }

        /* Logout Button Glow */
.logout-btn-anime:hover {
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
    transform: scale(1.02);
}

@keyframes discord-shake {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(15deg); }
  50% { transform: rotate(-15deg); }
  75% { transform: rotate(15deg); }
  100% { transform: rotate(0deg); }
}

.animate-discord {
  animation: discord-shake 0.5s ease-in-out infinite;
  animation-play-state: paused;
}

/* Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø² ÙŠØ¹Ù…Ù„ Ø¹Ù†Ø¯ Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø§ÙˆØ³ØŒ Ø£Ùˆ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 5 Ø«ÙˆØ§Ù†Ù */
.group:hover .animate-discord, 
.discord-trigger {
  animation-play-state: running;
}

.discord-btn {
  background: linear-gradient(45deg, #5865F2, #7c30ff);
  box-shadow: 0 0 15px rgba(88, 101, 242, 0.4);
}

/* Adjust Main Container to not be covered by sidebar */
body {
    padding-left: 90px; /* Provides space for the collapsed sidebar */
}
        .mode-btn { opacity: 0.5; border: 1px solid transparent; color: var(--text-color); }
        .mode-btn.active { opacity: 1; border-color: var(--accent-color); color: var(--accent-color); }

        input[type="color"] { -webkit-appearance: none; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; background: none; }
        input[type="color"]::-webkit-color-swatch { border: 2px solid white; border-radius: 50%; }

        .custom-scrollbar::-webkit-scrollbar { width: 5px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--accent-color); border-radius: 10px; }
    </style>
</head>
<body class="p-4 pb-10">
    <div id="loading-screen" class="fixed inset-0 z-[9999] bg-[#000000] flex flex-col items-center justify-center transition-opacity duration-700">
    <video id="loading-video" autoplay muted playsinline class="w-64 h-64 md:w-80 md:h-80 object-contain">
        <source src="Anime.mp4" type="video/mp4">
    </video>
    
    <div class="mt-4 flex flex-col items-center">
        <div class="w-48 h-1 bg-white/10 rounded-full overflow-hidden">
            <div id="progress-bar" class="h-full bg-[#7c30ff] w-0 transition-all duration-300 shadow-[0_0_10px_#7c30ff]"></div>
        </div>
        <p class="text-[10px] uppercase tracking-[0.3em] mt-3 text-white opacity-50 font-bold animate-pulse">
        . . . . L O A D I N G
        </p>
    </div>
</div>
<button id="openNav" class="fixed left-4 top-4 z-[1100] text-white bg-gradient-to-br from-[#7c30ff] to-[#6020dd] w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-700 ease-out hover:scale-110 active:scale-95 shadow-[0_8px_30px_rgba(124,48,255,0.4)] hover:shadow-[0_20px_60px_rgba(255,48,124,0.4),0_10px_40px_rgba(48,255,200,0.3),0_5px_20px_rgba(255,200,48,0.3)] hover:brightness-110 animate-shadow-pulse group">
    <i class="fas fa-bars transition-transform duration-500 group-hover:rotate-180"></i>
</button>

<style>
@keyframes shadow-pulse {
    0%, 100% {
        filter: drop-shadow(0 8px 20px rgba(124, 48, 255, 0.5))
                drop-shadow(0 0 30px rgba(124, 48, 255, 0.3));
    }
    25% {
        filter: drop-shadow(0 8px 20px rgba(255, 48, 124, 0.5))
                drop-shadow(0 0 30px rgba(255, 48, 200, 0.4));
    }
    50% {
        filter: drop-shadow(0 8px 20px rgba(48, 200, 255, 0.5))
                drop-shadow(0 0 30px rgba(48, 255, 200, 0.4));
    }
    75% {
        filter: drop-shadow(0 8px 20px rgba(255, 200, 48, 0.5))
                drop-shadow(0 0 30px rgba(255, 150, 48, 0.4));
    }
}

.animate-shadow-pulse {
    animation: shadow-pulse 4s ease-in-out infinite;
}

.animate-shadow-pulse:hover {
    animation: shadow-pulse 1.5s ease-in-out infinite;
}
</style>

<nav id="sideNav" class="fixed left-0 top-0 z-[1000] flex h-full w-0 overflow-hidden flex-col bg-[#121212]/95 backdrop-blur-md transition-all duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] border-r border-[#7c30ff]/0 shadow-2xl">
    
    <div class="flex justify-end p-4">
        <button id="closeNav" class="text-gray-400 hover:text-[#7c30ff] transition-colors">
            <i class="fas fa-times text-xl"></i>
        </button>
    </div>

    <div class="relative flex items-center px-5 py-4 mb-4">
        <div class="flex items-center justify-center min-w-[30px]">
            <i class="fas fa-dragon text-2xl text-[#7c30ff] drop-shadow-[0_0_8px_rgba(124,48,255,0.6)]"></i>
        </div>
        <div class="ml-4 whitespace-nowrap">
            <span class="text-lg font-black tracking-widest text-white uppercase">PhineX <span class="text-[#7c30ff]">|</span> El Jasus</span>
        </div>
    </div>

    <ul class="flex-grow py-2 space-y-1">
        <li>
            <a href="index.html" class="flex items-center px-5 py-4 text-gray-200 hover:bg-[#7c30ff]/10 transition-all relative">
                <i class="fas fa-home min-w-[30px] text-lg text-[#7c30ff]"></i>
                <span class="mr-6 font-bold">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </a>
        </li>
        <li>
            <a href="login.html" class="flex items-center px-5 py-4 text-gray-200 hover:bg-[#7c30ff]/10 transition-all relative">
                <i class="fas fa-sign-in-alt min-w-[30px] text-lg text-[#7c30ff]"></i>
                <span class="mr-6 font-bold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
            </a>
        </li>
        <li>
            <a href="signup.html" class="flex items-center px-5 py-4 text-gray-200 hover:bg-[#7c30ff]/10 transition-all relative">
                <i class="fas fa-user-plus min-w-[30px] text-lg text-[#7c30ff]"></i>
                <span class="mr-6 font-bold">Ø§Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</span>
            </a>
        </li>
        <li>
            <a href="howtoplay.html" class="flex items-center px-5 py-4 text-gray-200 hover:bg-[#7c30ff]/10 transition-all relative">
                <i class="fas fa-book-open min-w-[30px] text-lg text-[#7c30ff]"></i>
                <span class="mr-6 font-bold">ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</span>
            </a>
        </li>
        <li class="px-3 mt-4">
            <a href="https://discord.gg/xBQ3ewVVHk" target="_blank" 
            class="discord-btn group/discord flex items-center justify-center rounded-xl p-3 text-white transition-all duration-300 hover:scale-105 active:scale-95 relative overflow-hidden">
                
                <div class="absolute inset-0 bg-white/20 translate-x-[-100%] group-hover/discord:translate-x-[100%] transition-transform duration-700"></div>
                
                <i class="fab fa-discord text-xl animate-discord"></i>
                
                <span class="mr-3 max-w-0 overflow-hidden opacity-0 transition-all duration-500 group-hover:max-w-xs group-hover:opacity-100 font-black text-[10px] tracking-tighter whitespace-nowrap uppercase">
                    Ø§Ù†Ø¶Ù… Ù„Ù…Ø¬ØªÙ…Ø¹Ù†Ø§
                </span>
            </a>
        </li>
    </ul>
    <div class="p-4 border-t border-white/5 bg-black/40 relative">
    
    <div class="flex justify-center mb-2">
        <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-md bg-red-500/10 border border-red-500/20">
            <span class="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"></span>
            <span class="text-[9px] uppercase font-black tracking-[0.2em] text-red-500/80">
                ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹
            </span>
        </span>
    </div>
    
    <button id="logoutBtn" class="flex w-full items-center justify-center rounded-xl bg-white/5 border border-white/10 p-3 text-gray-500 cursor-not-allowed transition-all group/logout">
        <i class="fas fa-sign-out-alt min-w-[30px] text-lg opacity-50"></i>
        <span class="ml-2 max-w-xs overflow-hidden font-bold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
    </button>
</div>
</nav>
    <div class="max-w-md mx-auto">
        <header class="text-center py-6 animate__animated animate__fadeIn">
            <img src="ElJasus2.png" alt="Logo" class="w-20 h-20 mx-auto rounded-full border-2 dynamic-border-primary mb-2 shadow-xl">
            <h1 class="text-3xl font-900 italic uppercase tracking-tighter">El <span class="dynamic-text-primary">Jasus</span></h1>

            <div class="flex justify-center mt-4">
                <div class="inline-flex bg-black/40 p-1 rounded-xl border border-white/5">
                    <button id="setLocal" onclick="switchMode('local')" class="mode-btn active px-5 py-2 rounded-lg text-xs font-bold">Ù…Ø­Ù„ÙŠ</button>
                    <button id="setOnline" onclick="switchMode('online')" class="mode-btn px-5 py-2 rounded-lg text-xs font-bold">Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</button>
                </div>
            </div>
        </header>

        <div class="glass rounded-3xl p-4 mb-4 border border-white/10 animate__animated animate__fadeIn">
            <div class="flex justify-between items-center mb-3 px-2">
                <h2 class="text-[10px] font-black uppercase tracking-widest opacity-50">ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</h2>
                <button onclick="resetTheme()" class="text-[9px] bg-red-500/20 text-red-500 px-2 py-1 rounded">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
            </div>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><input type="color" id="colorBg" oninput="updateLiveTheme()"><span class="text-[8px] mt-1">Ø§Ù„Ø®Ù„ÙÙŠØ©</span></div>
                <div class="flex flex-col items-center"><input type="color" id="colorCard" oninput="updateLiveTheme()"><span class="text-[8px] mt-1">Ø§Ù„ÙƒØ±ÙˆØª</span></div>
                <div class="flex flex-col items-center"><input type="color" id="colorBtn" oninput="updateLiveTheme()"><span class="text-[8px] mt-1">Ø§Ù„Ø£Ø²Ø±Ø§Ø±</span></div>
                <div class="flex flex-col items-center"><input type="color" id="colorText" oninput="updateLiveTheme()"><span class="text-[8px] mt-1">Ø§Ù„Ù†ØµÙˆØµ</span></div>
            </div>
        </div>

        <div id="setup-screen" class="glass rounded-[2rem] p-6 shadow-2xl animate__animated animate__fadeInUp">
            <div class="mb-5">
                <label class="text-[10px] font-bold opacity-50 uppercase block mb-2 px-1">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</label>
                <select id="gameCat" class="w-full bg-black/40 p-4 rounded-xl border border-white/5 outline-none focus:dynamic-border-primary text-sm appearance-none cursor-pointer">
                    <option value="places">ğŸŒ Ø£Ù…Ø§ÙƒÙ† Ø³ÙŠØ§Ø­ÙŠØ©</option>
                    <option value="food">ğŸ• Ø£ÙƒÙ„Ø§Øª Ù…ØµØ±ÙŠØ©</option>
                    <option value="jobs">ğŸ› ï¸ Ù…Ù‡Ù† ÙˆÙˆØ¸Ø§Ø¦Ù</option>
                    <option value="companies">ğŸ¢ Ø´Ø±ÙƒØ§Øª Ø¹Ø§Ù„Ù…ÙŠØ©</option>
                    <option value="football_teams">âš½ Ø£Ù†Ø¯ÙŠØ© ÙˆÙ…Ù†ØªØ®Ø¨Ø§Øª ÙƒÙˆØ±Ø©</option>
                </select>
            </div>

            <div id="local-fields" class="space-y-4">
                <div class="flex items-center justify-between px-1">
                    <label class="text-[10px] font-bold opacity-50 uppercase">Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</label>
                    <div class="flex items-center gap-3">
                        <button onclick="changeLocalCount(-1)" class="w-7 h-7 rounded-full bg-white/5 border border-white/10">-</button>
                        <span id="localCountDisplay" class="font-black dynamic-text-primary">3</span>
                        <button onclick="changeLocalCount(1)" class="w-7 h-7 rounded-full bg-white/5 border border-white/10">+</button>
                    </div>
                </div>
                <div id="localNamesContainer" class="space-y-2 max-h-40 overflow-y-auto pr-1 custom-scrollbar"></div>
                <button onclick="startLocalGame()" class="w-full btn-main py-4 rounded-xl mt-2 shadow-lg">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¬ÙˆÙ„Ø© ğŸ®</button>
            </div>
            
            <div id="online-fields" class="hidden space-y-4">
                <input type="text" id="pName" placeholder="Ø§Ø³Ù…Ùƒ..." class="w-full bg-black/40 border border-white/5 p-4 rounded-xl text-center outline-none focus:dynamic-border-primary">
                <div class="grid grid-cols-2 gap-2">
                    <button id="createBtn" class="bg-white/5 border border-white/10 py-4 rounded-xl font-bold text-xs">Ø¥Ù†Ø´Ø§Ø¡</button>
                    <button id="joinBtn" class="bg-white/5 border border-white/10 py-4 rounded-xl font-bold text-xs">Ø§Ù†Ø¶Ù…Ø§Ù…</button>
                </div>
                <div id="public-lobby" class="mt-4 border-t border-white/10 pt-4">
                    <h3 class="text-sm font-bold mb-2">ğŸ” ØºØ±Ù Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø©</h3>
                    <div class="max-h-40 overflow-y-auto space-y-2" id="publicRoomsList">
                        <p class="text-[10px] opacity-50 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ ØºØ±Ù Ø¹Ø§Ù…Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="game-screen" class="hidden text-center animate__animated animate__fadeIn">
            <div class="mb-4">
                <p class="text-[10px] dynamic-text-primary font-bold uppercase tracking-widest italic mb-1"> Ø¯ÙˆØ± Ø§Ù„Ù„Ø§Ø¹Ø¨</p>
                <h3 id="targetPlayer" class="text-3xl font-black">---</h3>
            </div>
            <div id="secretCard" class="h-80 glass rounded-[2.5rem] border-2 border-dashed dynamic-border-primary flex flex-col items-center justify-center cursor-pointer shadow-2xl transition-all">
                <i class="fas fa-fingerprint text-6xl mb-4 opacity-20"></i>
                <p class="font-bold opacity-50">Ø§Ù†Ù‚Ø± Ù„Ù„ÙƒØ´Ù ğŸ”’</p>
            </div>
            <button id="nextBtn" class="hidden mt-6 w-full dynamic-bg-primary py-5 rounded-2xl font-black italic shadow-xl">Ø§Ù„ØªØ§Ù„ÙŠ âœ”ï¸</button>
        </div>
    </div>
    
   <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‚Ø§Ø´ -->
<div id="discussion-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
  <div class="glass w-full max-w-4xl rounded-[2.5rem] p-6 border border-white/10 shadow-2xl relative max-h-[90vh] overflow-y-auto">
    <!-- Ø²Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù… -->
    <button id="toggleChatBtn" class="fixed top-6 left-6 z-[60] bg-cyan-500 text-black w-12 h-12 rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-all">
      <i class="fas fa-comments text-xl"></i>
    </button>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„Ù‚Ø© -->
    <div id="chatWindow" class="hidden fixed top-20 left-6 z-[60] w-80 glass rounded-2xl p-4 border border-cyan-500/30 shadow-2xl animate__animated animate__slideInLeft">
      <div class="flex justify-between items-center mb-3">
        <h3 class="text-sm font-black text-cyan-400">ğŸ’¬ Ø§Ù„Ø´Ø§Øª</h3>
        <button id="closeChatBtn" class="text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div id="discussionMessages" class="h-64 overflow-y-auto custom-scrollbar mb-3 text-right text-xs bg-black/40 p-3 rounded-xl border border-white/10"></div>
      <div class="flex gap-2">
        <input id="discussionInput" type="text" class="flex-1 bg-black/40 border border-white/10 p-2 rounded-lg text-xs outline-none" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
        <button id="sendDiscussionBtn" class="dynamic-bg-primary px-3 rounded-lg text-xs font-black">
          Ø¥Ø±Ø³Ø§Ù„
        </button>
      </div>
    </div>

    <h2 class="text-2xl font-black mb-4 text-center dynamic-text-primary">Ù†Ù‚Ø§Ø´ Ø§Ù„Ø¬ÙˆÙ„Ø© ğŸ—£ï¸</h2>
    
    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ¨Ù‡ Ø¨Ù‡Ù… -->
    <div id="suspectsList" class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6"></div>

    <button id="goVoteBtn" class="w-full bg-purple-600/80 py-4 rounded-2xl font-black text-sm shadow-xl hover:scale-102 transition-all">
      Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØµÙˆÙŠØª âœ…
    </button>
    <p id="discussionInfo" class="text-[10px] opacity-60 mt-2 text-center">
      Ø³ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØµÙˆÙŠØª Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¶ØºØ· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„.
    </p>
  </div>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª -->
<div id="voting-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
  <div class="glass w-full max-w-2xl rounded-[2.5rem] p-6 border border-white/10 shadow-2xl relative">
    <h2 class="text-2xl font-black mb-4 text-center dynamic-text-primary">Ø§Ù„ØªØµÙˆÙŠØª ğŸ•µï¸â€â™‚ï¸</h2>
    <p class="text-sm opacity-70 mb-4 text-center">Ø§Ø®ØªØ± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø°ÙŠ ØªØ´Ùƒ Ø£Ù†Ù‡ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³</p>
    
    <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªØµÙˆÙŠØª -->
    <div id="voteCards" class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6"></div>
    
    <p id="votingStatus" class="text-xs opacity-60 mt-4 text-center"></p>
  </div>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„ -->
<div id="tie-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/95 backdrop-blur-md animate__animated animate__fadeIn">
  <h1 class="text-8xl font-black text-yellow-500 animate__animated animate__bounceIn" style="text-shadow: 0 0 30px rgba(234, 179, 8, 0.8);">
    ØªØ¹Ø§Ø¯Ù„! ğŸ¤
  </h1>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø³Ø¨ÙŠÙ†Ø± -->
<div id="spinner-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
  <div class="glass w-full max-w-md rounded-[2.5rem] p-6 border border-white/10 shadow-2xl text-center">
    <h2 class="text-2xl font-black mb-4 dynamic-text-primary">Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ ğŸ¯</h2>
    <p class="text-sm opacity-70 mb-4">Ø­Ø¯Ø« ØªØ¹Ø§Ø¯Ù„ØŒ Ø³ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù„Ø§Ø¹Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ</p>
    
    <div id="spinnerWheel" class="relative w-64 h-64 mx-auto mb-6 bg-gradient-to-br from-purple-900 to-pink-900 rounded-full border-4 border-yellow-500 flex items-center justify-center">
      <div id="spinnerPointer" class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-4 w-0 h-0 border-l-8 border-r-8 border-t-16 border-transparent border-t-yellow-500 z-10"></div>
      <div id="spinnerContent" class="text-3xl font-black text-white"></div>
    </div>
    
    <button id="startSpinnerBtn" class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 py-4 rounded-2xl font-black text-lg shadow-xl hover:scale-105 transition-all">
      Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø³Ø­Ø¨ ğŸ°
    </button>
  </div>
</div>

<!-- Ø´Ø§Ø´Ø© ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ -->
<div id="spy-guess-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
  <div class="glass w-full max-w-2xl rounded-[2.5rem] p-6 border border-red-500/30 shadow-2xl text-center">
    <h2 class="text-2xl font-black mb-2 text-red-500">ğŸ•µï¸ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø§Ù„Ù…ÙƒØ´ÙˆÙ</h2>
    <p id="spyNameDisplay" class="text-xl mb-4 font-bold"></p>
    <p class="text-sm opacity-70 mb-4">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</p>
    
    <div id="categoryWordsList" class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6 max-h-96 overflow-y-auto custom-scrollbar"></div>
    
    <p id="guessResult" class="text-lg font-black mt-4"></p>
  </div>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© -->
<div id="result-screen" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
  <div class="glass w-full max-w-lg rounded-[2.5rem] p-8 border border-white/10 shadow-2xl text-center">
    <div id="resultIcon" class="text-8xl mb-4"></div>
    <h2 id="resultTitle" class="text-3xl font-black mb-2"></h2>
    <p id="resultMessage" class="text-lg mb-6"></p>
    <button id="returnToRoomBtn" class="w-full dynamic-bg-primary py-4 rounded-2xl font-black shadow-xl">
      Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØºØ±ÙØ© ğŸ 
    </button>
  </div>
</div>

    <div id="room-overlay" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate__animated animate__fadeIn">
        <div class="glass w-full max-w-sm rounded-[2.5rem] p-6 border border-white/10 shadow-2xl relative">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <h2 class="text-2xl font-black dynamic-text-primary cursor-pointer" id="roomCodeContainer" title="Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®">
                        <span id="displayRoomCode">----</span> <i class="fas fa-copy text-[10px] opacity-30"></i>
                    </h2>
                    <p class="text-[9px] opacity-50 uppercase font-bold tracking-widest">ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©</p>
                </div>
                <button id="leaveRoomBtn" class="bg-red-500/10 text-red-500 text-[10px] px-3 py-2 rounded-xl font-bold border border-red-500/20">Ù…ØºØ§Ø¯Ø±Ø©</button>
            </div>

            <div id="host-controls" class="hidden space-y-3 mb-6 bg-white/5 p-4 rounded-2xl border border-white/5">
                <label class="text-[8px] font-bold opacity-40 uppercase">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¶ÙŠÙ</label>
                <select id="updateCat" onchange="updateRoomSettings()" class="w-full bg-black/40 text-xs p-3 rounded-xl border border-white/10 outline-none">
                    <option value="places">ğŸŒ Ø£Ù…Ø§ÙƒÙ† Ø³ÙŠØ§Ø­ÙŠØ©</option>
                    <option value="food">ğŸ• Ø£ÙƒÙ„Ø§Øª Ù…ØµØ±ÙŠØ©</option>
                    <option value="jobs">ğŸ› ï¸ Ù…Ù‡Ù† ÙˆÙˆØ¸Ø§Ø¦Ù</option>
                    <option value="companies">ğŸ¢ Ø´Ø±ÙƒØ§Øª Ø¹Ø§Ù„Ù…ÙŠØ©</option>
                    <option value="football_teams">âš½ Ø£Ù†Ø¯ÙŠØ© ÙˆÙ…Ù†ØªØ®Ø¨Ø§Øª ÙƒÙˆØ±Ø©</option>
                </select>
                <div class="flex items-center justify-between bg-black/40 p-3 rounded-xl mb-3 border border-white/10">
                    <span class="text-xs font-bold">Ù†ÙˆØ¹ Ø§Ù„ØºØ±ÙØ©:</span>
                    <button id="toggleVisibility" onclick="toggleRoomVisibility()" class="text-xs px-4 py-1 rounded-full border transition-all"></button>
                </div>
            </div>

            <div class="mb-6">
                <div class="flex justify-between items-center mb-3">
                    <label class="text-[10px] font-bold opacity-50 uppercase tracking-widest">Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ù…ØªØµÙ„ÙˆÙ†</label>
                    <span id="pCount" class="text-[10px] font-black dynamic-text-primary">0/10</span>
                </div>
                <div id="roomPlayersList" class="space-y-2 max-h-48 overflow-y-auto pr-1 custom-scrollbar"></div>
            </div>

            <button id="hostStartBtn" class="hidden w-full btn-main py-4 rounded-2xl font-black shadow-xl disabled:opacity-30 disabled:cursor-not-allowed">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨ ğŸš€</button>
            <div id="guestWaitMsg" class="hidden text-center py-2 opacity-40 animate-pulse text-xs font-bold">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø¶ÙŠÙ...</div>
            <div id="minPlayersMsg" class="hidden text-center text-[10px] text-yellow-500 mt-2">ÙŠØ¬Ø¨ ØªÙˆÙØ± 3 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</div>
        </div>
    </div>

    <script type="module">
    // Function to handle the loading screen
    window.addEventListener('load', () => {
        const loader = document.getElementById('loading-screen');
        const progressBar = document.getElementById('progress-bar');
        const video = document.getElementById('loading-video');

        video.ontimeupdate = () => {
            const percentage = (video.currentTime / video.duration) * 100;
            progressBar.style.width = percentage + '%';
        };

        video.onended = () => {
            progressBar.style.width = '100%';
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        };

        setTimeout(() => {
            if (loader.style.display !== 'none') {
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
            }
        }, 5000);
    });

    const sideNav = document.getElementById('sideNav');
    const openBtn = document.getElementById('openNav');
    const closeBtn = document.getElementById('closeNav');

    openBtn.addEventListener('click', () => {
        sideNav.style.width = '260px';
        sideNav.style.borderRightWidth = '1px';
        sideNav.style.borderColor = 'rgba(124, 48, 255, 0.4)';
        openBtn.style.opacity = '0';
        openBtn.style.pointerEvents = 'none';
    });

    closeBtn.addEventListener('click', () => {
        sideNav.style.width = '0';
        sideNav.style.borderRightWidth = '0';
        openBtn.style.opacity = '1';
        openBtn.style.pointerEvents = 'auto';
    });

    document.addEventListener('click', (e) => {
        if (!sideNav.contains(e.target) && !openBtn.contains(e.target) && sideNav.style.width === '260px') {
            closeBtn.click();
        }
    });
    
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getDatabase, ref, set, onValue, update, get, remove, onDisconnect } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDnd-pmKEatI3DaFz6xHWB5ucurtHXt9tk",
        authDomain: "el-jasus.firebaseapp.com",
        databaseURL: "https://el-jasus-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "el-jasus",
        appId: "1:415659587906:web:782f7940176ea4097eb0db"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const gameData = {
        places: [
            "Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", "Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰", "Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø­ÙŠÙˆØ§Ù†", "Ø§Ù„Ù…Ø·Ø§Ø±", "Ø§Ù„Ù†Ø§Ø¯ÙŠ", "Ø§Ù„Ø³ÙŠÙ†Ù…Ø§", "Ø§Ù„Ù…Ø·Ø¹Ù…", "Ø§Ù„Ø¨Ø­Ø±", "Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", "Ø§Ù„Ø³ÙŠØ±Ùƒ",
            "Ø§Ù„Ù…ÙƒØªØ¨Ø©", "Ø§Ù„Ù…Ø³Ø¬Ø¯", "Ø§Ù„Ù…Ø­Ù„", "Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ©", "Ø§Ù„Ø¨Ù†Ùƒ", "Ø§Ù„Ù…Ø­ÙƒÙ…Ø©", "Ø§Ù„Ø³Ø¬Ù†", "Ø§Ù„ØºØ§Ø¨Ø©", "Ø§Ù„ØµØ­Ø±Ø§Ø¡",
            "Ø§Ù„Ø¬Ø¨Ù„", "Ø§Ù„Ù‚Ù„Ø¹Ø©", "Ø§Ù„Ù‚ØµØ±", "Ø§Ù„ÙÙ†Ø¯Ù‚", "Ø§Ù„Ù…ØªØ­Ù", "Ø§Ù„Ù…Ø³Ø±Ø­", "Ø§Ù„Ù…Ø®Ø¨Ø²", "Ø§Ù„Ù…Ù‚Ù‡Ù‰ (Ø§Ù„Ù‚Ù‡ÙˆØ©)", "Ø§Ù„Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª", "Ù…Ø­Ø·Ø© Ø§Ù„Ù‚Ø·Ø§Ø±",
            "Ù…Ø­Ø·Ø© Ø§Ù„Ù…ØªØ±Ùˆ", "Ø§Ù„ÙˆØ±Ø´Ø©", "Ø§Ù„Ø§Ø³ØªØ§Ø¯", "Ø§Ù„Ø¬ÙŠÙ…", "Ø§Ù„Ø­Ø¶Ø§Ù†Ø©", "Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©", "ØµØ§Ù„ÙˆÙ† Ø§Ù„Ø­Ù„Ø§Ù‚Ø©", "Ø§Ù„Ù…Ø¹Ù…Ù„", "Ø§Ù„Ù…Ù†Ø²Ù„", "Ø§Ù„Ù…Ø·Ø¨Ø®",
            "ØºØ±ÙØ© Ø§Ù„Ù†ÙˆÙ…", "Ø§Ù„Ø­Ù…Ø§Ù…", "Ø§Ù„Ø³Ø·ÙˆØ­", "Ø§Ù„Ø´Ø§Ø±Ø¹", "Ø§Ù„ÙƒÙˆØ¨Ø±ÙŠ", "Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡", "Ø§Ù„Ø³ÙØ§Ø±Ø©", "Ø§Ù„Ù…Ø±ØµØ¯", "Ø§Ù„Ù…Ø®ÙŠÙ…", "Ø§Ù„Ø´Ù„Ø§Ù„",
            "Ø§Ù„Ø¨Ø­ÙŠØ±Ø©", "Ø§Ù„ÙƒÙ‡Ù", "Ø§Ù„Ù…Ø³Ø¨Ø­ (Ø§Ù„Ø¨ÙŠØ³ÙŠÙ†)", "Ø§Ù„Ù…ØµÙ†Ø¹", "Ø§Ù„Ù…ÙƒØªØ¨", "Ø§Ù„Ø£ØªÙˆØ¨ÙŠØ³", "Ø§Ù„Ø·ÙŠØ§Ø±Ø©", "Ø§Ù„Ù…Ø±ÙƒØ¨", "Ø§Ù„ÙØ¶Ø§Ø¡", "Ø§Ù„Ù‚Ù…Ø±",
            "Ø§Ù„Ù…Ø±ÙŠØ®", "Ø§Ù„Ø³ÙˆÙ‚", "Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ", "Ø­Ø¯ÙŠÙ‚Ø© Ø¹Ø§Ù…Ø©", "Ø§Ù„Ø´Ù‚Ø©", "Ø§Ù„ÙÙŠÙ„Ø§", "Ø§Ù„Ø®ÙŠÙ…Ø©", "Ø§Ù„Ø¬Ø±Ø§Ø¬", "Ø§Ù„Ù…ØµÙ„Ø­Ø© Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©", "Ø§Ù„Ø¨Ø±ÙŠØ¯",
            "Ù‚Ø³Ù… Ø§Ù„Ø´Ø±Ø·Ø©", "Ø§Ù„Ù…Ø·Ø§ÙØ¦", "Ø§Ù„Ø¥Ø³Ø¹Ø§Ù", "Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©", "Ø§Ù„Ù…ÙˆÙ„", "Ù…Ø­Ù„ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„Ø§Øª", "Ø§Ù„Ø³Ø§ÙŠØ¨Ø±", "Ø§Ø³ØªÙˆØ¯ÙŠÙˆ ØªØµÙˆÙŠØ±", "Ù‚Ø§Ø¹Ø© Ø£ÙØ±Ø§Ø­", "Ø¹Ø²Ø§Ø¡",
            "Ù…Ø¹Ø±Ø¶ Ø³ÙŠØ§Ø±Ø§Øª", "Ù…Ø­Ù„ ÙˆØ±Ø¯", "Ù…Ø­Ù„ Ù‡Ø¯Ø§ÙŠØ§", "ÙƒØ´Ùƒ", "Ø¨Ù†Ø²ÙŠÙ†Ø©", "Ù…ÙˆÙ‚Ù Ù…ÙŠÙƒØ±ÙˆØ¨Ø§ØµØ§Øª", "Ù…ØºØ³Ù„Ø© Ø³ÙŠØ§Ø±Ø§Øª", "Ù…Ø­Ù„ Ø­Ù„ÙˆÙŠØ§Øª", "ÙØ±Ù† Ø¹ÙŠØ´", "Ù…Ø­Ù„ Ø³Ù…Ùƒ",
            "Ù…Ø­Ù„ Ø¬Ø²Ø§Ø±Ø©", "Ù…Ø­Ù„ Ø¨Ù‚Ø§Ù„Ø©", "ØµØ§Ù„Ø© Ø¨ÙˆÙ„ÙŠÙ†Ø¬", "ØªÙ†Ø³ Ø·Ø§ÙˆÙ„Ø©", "Ù…Ù„Ø¹Ø¨ ÙƒÙˆØ±Ø©", "Ø§Ù„Ø¨ÙˆØ±ØµØ©", "Ø§Ù„Ù…Ø¯Ø¨Ø­", "Ø§Ù„Ø¬Ø²ÙŠØ±Ø©", "Ø§Ù„Ù…Ù†Ø§Ø±Ø©", "Ø§Ù„Ù…Ù‚Ø§Ø¨Ø±"
        ],

        football_teams: [
            "Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙŠ", "Ø§Ù„Ø²Ù…Ø§Ù„Ùƒ", "Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠ", "Ø§Ù„Ù…ØµØ±ÙŠ Ø§Ù„Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯ÙŠ", "Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø³ÙƒÙ†Ø¯Ø±ÙŠ", "Ø¨ÙŠØ±Ø§Ù…ÙŠØ¯Ø²", "Ø³Ù…ÙˆØ­Ø©", "Ù…ÙˆØ¯Ø±Ù† ÙÙŠÙˆØªØ´Ø±", "Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ÙˆÙ† Ø§Ù„Ø¹Ø±Ø¨", "ØºØ²Ù„ Ø§Ù„Ù…Ø­Ù„Ø©", "Ø§Ù„Ø¬ÙˆÙ†Ø©", "Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ", "Ø³ÙŠØ±Ø§Ù…ÙŠÙƒØ§ ÙƒÙ„ÙŠÙˆØ¨Ø§ØªØ±Ø§", "Ø¥Ù†Ø¨ÙŠ", "Ø·Ù„Ø§Ø¦Ø¹ Ø§Ù„Ø¬ÙŠØ´", "Ø­Ø±Ø³ Ø§Ù„Ø­Ø¯ÙˆØ¯", "Ø£Ø³ÙˆØ§Ù†",
            "Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", "Ø§Ù„Ù†ØµØ± Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", "Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", "Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", "Ø§Ù„Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", "Ø§Ù„Ø¹ÙŠÙ† Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠ", "Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø£Ù‡Ù„ÙŠ", "Ø§Ù„ÙˆØ¯Ø§Ø¯ Ø§Ù„Ù…ØºØ±Ø¨ÙŠ", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…ØºØ±Ø¨ÙŠ", "Ø§Ù„Ø¬ÙŠØ´ Ø§Ù„Ù…Ù„ÙƒÙŠ", "Ø§Ù„ØªØ±Ø¬ÙŠ Ø§Ù„ØªÙˆÙ†Ø³ÙŠ", "Ø§Ù„Ù†Ø¬Ù… Ø§Ù„Ø³Ø§Ø­Ù„ÙŠ", "Ø§Ù„Ø¥ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„ØªÙˆÙ†Ø³ÙŠ", "Ø§Ù„Ø³Ø¯ Ø§Ù„Ù‚Ø·Ø±ÙŠ", "Ø§Ù„Ø¯Ø­ÙŠÙ„", "Ø§Ù„ÙƒÙˆÙŠØª Ø§Ù„ÙƒÙˆÙŠØªÙŠ", "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ© Ø§Ù„ÙƒÙˆÙŠØªÙŠ", "Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø£Ø±Ø¯Ù†ÙŠ", "Ø§Ù„Ø²ÙˆØ±Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ",
            "Ù„ÙŠÙØ±Ø¨ÙˆÙ„", "Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ", "Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯", "Ø£Ø±Ø³Ù†Ø§Ù„", "ØªØ´ÙŠÙ„Ø³ÙŠ", "ØªÙˆØªÙ†Ù‡Ø§Ù…", "Ø£Ø³ØªÙˆÙ† ÙÙŠÙ„Ø§", "Ù†ÙŠÙˆÙƒØ§Ø³Ù„ ÙŠÙˆÙ†Ø§ÙŠØªØ¯", "Ù„ÙŠØ³ØªØ± Ø³ÙŠØªÙŠ", "ÙˆØ³Øª Ù‡Ø§Ù…",
            "Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯", "Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©", "Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯", "Ø¥Ø´Ø¨ÙŠÙ„ÙŠØ©", "ÙØ§Ù„Ù†Ø³ÙŠØ§", "Ø±ÙŠØ§Ù„ Ø³ÙˆØ³ÙŠØ¯Ø§Ø¯", "ÙÙŠØ§Ø±ÙŠØ§Ù„", "Ø¨ÙŠÙ„Ø¨Ø§Ùˆ",
            "ÙŠÙˆÙÙ†ØªÙˆØ³", "Ø¥ÙŠÙ‡ Ø³ÙŠ Ù…ÙŠÙ„Ø§Ù†", "Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†", "Ù†Ø§Ø¨ÙˆÙ„ÙŠ", "Ø±ÙˆÙ…Ø§", "Ù„Ø§ØªØ³ÙŠÙˆ", "ÙÙŠÙˆØ±Ù†ØªÙŠÙ†Ø§", "Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®", "Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯", "Ø¨Ø§ÙŠØ± Ù„ÙŠÙØ±ÙƒÙˆØ²Ù†", "Ù„Ø§ÙŠØ¨Ø²ÙŠØ¬", "Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†", "Ù…Ø§Ø±Ø³ÙŠÙ„ÙŠØ§", "Ù„ÙŠÙˆÙ†", "Ù…ÙˆÙ†Ø§ÙƒÙˆ", "Ø£ÙŠØ§ÙƒØ³ Ø£Ù…Ø³ØªØ±Ø¯Ø§Ù…", "Ø¨Ù†ÙÙŠÙƒØ§", "Ø¨ÙˆØ±ØªÙˆ",
            "Ù…Ù†ØªØ®Ø¨ Ù…ØµØ±", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ù…ØºØ±Ø¨", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "Ù…Ù†ØªØ®Ø¨ ØªÙˆÙ†Ø³", "Ù…Ù†ØªØ®Ø¨ Ù‚Ø·Ø±", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†", "Ù…Ù†ØªØ®Ø¨ ÙØ±Ù†Ø³Ø§", "Ù…Ù†ØªØ®Ø¨ Ø£Ù„Ù…Ø§Ù†ÙŠØ§", "Ù…Ù†ØªØ®Ø¨ Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§", "Ù…Ù†ØªØ®Ø¨ Ø¥ÙŠØ·Ø§Ù„ÙŠØ§", "Ù…Ù†ØªØ®Ø¨ Ø¥Ù†Ø¬Ù„ØªØ±Ø§", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø¨Ø±ØªØºØ§Ù„", "Ù…Ù†ØªØ®Ø¨ Ø¨Ù„Ø¬ÙŠÙƒØ§", "Ù…Ù†ØªØ®Ø¨ ÙƒØ±ÙˆØ§ØªÙŠØ§", "Ù…Ù†ØªØ®Ø¨ Ù‡ÙˆÙ„Ù†Ø¯Ø§", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†", "Ù…Ù†ØªØ®Ø¨ ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ø³Ù†ØºØ§Ù„", "Ù…Ù†ØªØ®Ø¨ Ù†ÙŠØ¬ÙŠØ±ÙŠØ§", "Ù…Ù†ØªØ®Ø¨ Ø§Ù„ÙƒØ§Ù…ÙŠØ±ÙˆÙ†"
        ],

        food: [
            "ÙƒØ´Ø±ÙŠ", "Ù…Ù„ÙˆØ®ÙŠØ©", "ÙÙˆÙ„", "Ø·Ø¹Ù…ÙŠØ© (ÙÙ„Ø§ÙÙ„)", "ÙØªØ© Ø¨Ø§Ù„Ù„Ø­Ù…Ø©", "Ø­ÙˆØ§ÙˆØ´ÙŠ", "Ù…Ø­Ø´ÙŠ ÙƒØ±Ù†Ø¨", "Ù…Ø­Ø´ÙŠ ÙˆØ±Ù‚ Ø¹Ù†Ø¨", "Ù…Ù…Ø¨Ø§Ø±", "ÙƒÙˆØ§Ø±Ø¹",
            "ÙØªØ© ÙƒÙˆØ§Ø±Ø¹", "ÙƒÙØªØ© Ù…Ø´ÙˆÙŠØ©", "Ø·Ø±Ø¨", "ÙƒØ¨Ø§Ø¨", "ÙƒØ¨Ø¯Ø© Ø¥Ø³ÙƒÙ†Ø¯Ø±Ø§Ù†ÙŠ", "Ø³Ø¬Ù‚ Ø´Ø±Ù‚ÙŠ", "Ù…ÙƒØ±ÙˆÙ†Ø© Ø¨Ø´Ø§Ù…ÙŠÙ„", "Ø±Ù‚Ø§Ù‚ Ø¨Ø§Ù„Ù„Ø­Ù…Ø©", "Ø¬Ù„Ø§Ø´", "Ø£Ø±Ø² Ø¨Ù„Ø¨Ù†",
            "Ø£Ù… Ø¹Ù„ÙŠ", "Ø¨Ø³Ø¨ÙˆØ³Ø©", "ÙƒÙ†Ø§ÙØ©", "Ù„Ù‚ÙŠÙ…Ø§Øª (Ù‚Ø§Ø¶ÙŠ)", "ÙØ·ÙŠØ± Ù…Ø´Ù„ØªØª", "Ù…Ø´ ÙˆØ¬Ø¨Ù†Ø© Ù‚Ø¯ÙŠÙ…Ø©", "Ø¹Ø³Ù„ Ø£Ø³ÙˆØ¯ ÙˆØ·Ø­ÙŠÙ†Ø©", "ÙƒØ´Ùƒ", "Ø¨ØµØ§Ø±Ø©", "Ø¹Ø¯Ø³",
            "Ø´ÙˆØ±Ø¨Ø© Ù„Ø³Ø§Ù† Ø¹ØµÙÙˆØ±", "Ø£Ø±Ø² Ù…Ø¹Ù…Ø±", "Ù…Ø³Ù‚Ø¹Ø©", "ØªÙˆØ±Ù„ÙŠ Ø®Ø¶Ø§Ø±", "Ø¨Ø§Ù…ÙŠØ© Ø¨Ø§Ù„Ù„Ø­Ù…Ø©", "Ù‚Ù„Ù‚Ø§Ø³", "Ø³Ø¨Ø§Ù†Ø®", "Ø£Ø±Ø² Ø¨Ø§Ù„Ø´Ø¹Ø±ÙŠØ©", "ÙØ±Ø§Ø® Ù…Ø­Ù…Ø±Ø©", "Ø­Ù…Ø§Ù… Ù…Ø­Ø´ÙŠ",
            "Ø¨Ø·", "Ø£Ø±Ø§Ù†Ø¨", "Ø³Ù…Ùƒ Ø¨Ù„Ø·ÙŠ", "Ø³Ù…Ùƒ Ø¨ÙˆØ±ÙŠ", "Ø¬Ù…Ø¨Ø±ÙŠ", "Ø³Ø¨ÙŠØ·", "ÙØ³ÙŠØ®", "Ø±Ù†Ø¬Ø©", "Ù…Ù„ÙˆØ­Ø©", "Ø¨Ø·Ø§Ø·Ø³ Ù…Ø­Ù…Ø±Ø©","Ø¨Ø§Ø¨Ø§ ØºÙ†ÙˆØ¬", "Ø³Ù„Ø·Ø© Ø®Ø¶Ø±Ø§Ø¡", "Ù…Ø®Ù„Ù„ (Ø·Ø±Ø´ÙŠ)",
            "Ø¨Ø§Ø°Ù†Ø¬Ø§Ù† Ù…Ø®Ù„Ù„", "Ø¨ÙŠØ¶ Ø¨Ø§Ù„Ø¨Ø³Ø·Ø±Ù…Ø©", "Ø´ÙƒØ´ÙˆÙƒØ©", "Ø¹Ø¬Ø©", "Ù…Ø® Ø¨Ø§Ù†ÙŠÙ‡", "ÙƒØ¨Ø¯Ø© ÙˆÙ‚ÙˆØ§Ù†Øµ", "ÙƒÙØªØ©",
            "ÙƒÙØªØ© Ø£Ø±Ø²", "Ø£Ø±Ø² ØµÙŠØ§Ø¯ÙŠØ©", "ÙƒÙŠÙƒØ© Ø¨Ø±ØªÙ‚Ø§Ù„", "Ø±Ø² Ø¨Ù„Ø¨Ù†", "Ù…Ù‡Ù„Ø¨ÙŠØ©", "Ù‚Ù…Ø± Ø§Ù„Ø¯ÙŠÙ†", "Ø¹Ø§Ø´ÙˆØ±Ø§", "Ø²Ù„Ø§Ø¨ÙŠØ§", "Ø¨Ù„Ø­ Ø§Ù„Ø´Ø§Ù…", "ØµÙˆØ§Ø¨Ø¹ Ø²ÙŠÙ†Ø¨",
            "ÙƒØ­Ùƒ Ø§Ù„Ø¹ÙŠØ¯", "Ø¨Ø³ÙƒÙˆÙŠØª Ù†Ø´Ø§Ø¯Ø±", "ØºØ±ÙŠØ¨Ø©", "Ø¨ÙŠØªÙŠÙÙˆØ±", "Ù…Ù†ÙŠÙ† (Ù‚Ø±Ø§Ù‚ÙŠØ´)", "Ù‚Ø±Øµ Ø¨Ø¹Ø¬ÙˆØ©", "Ø¹ÙŠØ´ Ø¨Ù„Ø¯ÙŠ", "Ø¹ÙŠØ´ ÙÙŠÙ†Ùˆ", "Ø´Ø§ÙˆØ±Ù…Ø§ Ù…ØµØ±ÙŠ", "ÙØ±Ø§Ø® Ø¨Ø§Ù†ÙŠÙ‡",
            "ØµÙŠÙ†ÙŠØ© Ø¨Ø·Ø§Ø·Ø³", "Ù…ÙƒØ±ÙˆÙ†Ø© Ø¨Ø§Ù„ØµÙ„ØµØ©", "Ø³Ø§Ù†Ø¯ÙˆØªØ´ Ø¬Ø¨Ù†Ø©", "Ø´Ø§ÙŠ Ø¨Ù„Ø¨Ù†", "Ø³Ø­Ù„Ø¨", "Ø¹ØµÙŠØ± Ù‚ØµØ¨", "Ø¹Ø±Ù‚Ø³ÙˆØ³", "ØªÙ…Ø±Ù‡Ù†Ø¯ÙŠ", "Ø®Ø±ÙˆØ¨", "Ø³ÙˆØ¨ÙŠØ§",
            "Ù…Ø¯Ù…Ø³", "Ø¨ÙŠØ¶ Ù…Ø³Ù„ÙˆÙ‚", "Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§", "Ù„Ø§Ù†Ø´ÙˆÙ†", "Ø¨Ø³Ø·Ø±Ù…Ø©", "Ù…Ø®Ø±ÙˆØ·Ø©", "ÙƒÙˆØ³Ø© Ø¨Ø§Ù„Ø¨Ø´Ø§Ù…ÙŠÙ„", "Ø£Ø±Ø² Ø¨Ø§Ù„Ø®Ù„Ø·Ø©", "ÙƒØ¨Ø¯Ø© Ø¬Ù…Ù„ÙŠ", "ÙØ±ÙŠÙƒ"
        ],

        jobs: [
            "Ø¯ÙƒØªÙˆØ±", "Ù…Ù‡Ù†Ø¯Ø³", "Ù…Ø¯Ø±Ø³", "Ø¶Ø§Ø¨Ø·", "Ù…Ø­Ø§Ù…ÙŠ", "Ù…Ø­Ø§Ø³Ø¨", "Ù…Ù…Ø±Ø¶", "ØµÙŠØ¯Ù„ÙŠ", "Ø·ÙŠØ§Ø±", "Ø³ÙˆØ§Ù‚",
            "Ù†Ø¬Ø§Ø±", "Ø³Ø¨Ø§Ùƒ", "ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ", "Ù†Ù‚Ø§Ø´", "Ø¨Ù†Ø§", "Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ", "Ø­Ù„Ø§Ù‚", "Ø®ÙŠØ§Ø·", "Ø·Ø¨Ø§Ø®", "Ø¬Ø²Ø§Ø±",
            "Ø¨Ø§Ø¦Ø¹", "ØµØ­ÙÙŠ", "Ù…Ø°ÙŠØ¹", "Ù…Ù…Ø«Ù„", "Ù…ØºÙ†ÙŠ", "Ø±Ø³Ø§Ù…", "Ù…ØµÙˆØ±", "Ù„Ø§Ø¹Ø¨ ÙƒÙˆØ±Ø©", "Ù…Ø¯Ø±Ø¨", "Ø­ÙƒÙ…",
            "Ø¹Ø§Ù…Ù„ Ù†Ø¸Ø§ÙØ©", "Ø¨ÙˆØ§Ø¨", "Ø¹Ø§Ù…Ù„ Ø¯Ù„ÙŠÙØ±ÙŠ", "Ù†Ø¬Ø§Ø± Ù…Ø³Ù„Ø­", "Ø­Ø¯Ø§Ø¯", "ÙÙ„Ø§Ø­", "ØµÙŠØ§Ø¯", "Ù‚Ø§Ø¶ÙŠ", "Ø±Ø¬Ù„ Ø¥Ø·ÙØ§Ø¡", "Ø¹Ø³ÙƒØ±ÙŠ",
            "Ù…Ø£Ø°ÙˆÙ†", "Ø¥Ù…Ø§Ù… Ù…Ø³Ø¬Ø¯", "Ù‚Ø³ÙŠØ³", "Ù…Ø£Ù„Ù", "Ø´Ø§Ø¹Ø±", "Ù…Ø®Ø±Ø¬", "Ù…ÙˆÙ†ØªÙŠØ±", "Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ", "Ù…Ø¨Ø±Ù…Ø¬", "Ù‡ÙƒØ±",
            "Ø¹Ø§Ù„Ù…", "Ø±Ø§Ø¦Ø¯ ÙØ¶Ø§Ø¡", "ØºØ·Ø§Ø³", "Ø·ÙŠØ§Ø± Ø­Ø±Ø¨ÙŠ", "Ù…Ø¶ÙŠÙØ© Ø·ÙŠØ±Ø§Ù†", "Ù…ØªØ±Ø¬Ù…", "Ø³ÙƒØ±ØªÙŠØ±", "Ù…Ø¯ÙŠØ±", "ÙˆØ²ÙŠØ±", "Ø±Ø¦ÙŠØ³",
            "Ø®Ø¨ÙŠØ± ØªØ¬Ù…ÙŠÙ„", "Ù…ÙˆØ¯ÙŠÙ„", "ÙŠÙˆØªÙŠÙˆØ¨Ø±", "ØªÙŠÙƒØªÙˆÙƒØ±", "Ø¨Ù„ÙˆØ¬Ø±", "Ø¹Ø§Ù…Ù„ Ø¨Ù†Ø²ÙŠÙ†Ø©", "ØµØ±Ø§Ù", "Ø¬Ø±Ø³ÙˆÙ†", "Ø´ÙŠÙ", "Ø­Ù„ÙˆØ§Ù†ÙŠ",
            "Ø®ÙÙŠØ±", "Ø¨ÙˆØ¯ÙŠ Ø¬Ø§Ø±Ø¯", "Ù…Ø­Ù‚Ù‚", "Ø¬Ø§Ø³ÙˆØ³", "Ø±Ø¬Ù„ Ø£Ø¹Ù…Ø§Ù„", "Ø¨Ø§Ø¦Ø¹ Ø®Ø¶Ø§Ø±", "Ø¨Ø§Ø¦Ø¹ ÙØ§ÙƒÙ‡Ø©", "Ø¨Ø§Ø¦Ø¹ Ù„Ø¨Ù†", "Ù…ÙƒÙˆØ¬ÙŠ", "Ù…Ù†Ø¬Ø¯",
            "Ø¹Ø§Ù…Ù„ Ø¨Ù†Ø§Ø¡", "ÙÙ†ÙŠ ØªÙƒÙŠÙŠÙ", "ÙÙ†ÙŠ Ø±Ø§Ø¯ÙŠÙˆ", "Ø³Ø§Ø­Ø±", "Ù…Ù‡Ø±Ø¬", "Ø±Ø§Ù‚Øµ", "Ù…Ø¯Ø±Ø¨ Ø¬ÙŠÙ…", "Ø³Ø¨Ø§Ø­ Ù…Ø­ØªØ±Ù", "Ø¹Ø§Ù…Ù„ Ù…Ù†Ø¬Ù…", "Ø¹Ø§Ù…Ù„ Ø´Ø­Ù†",
            "Ø³Ø§Ø¹ÙŠ Ø¨Ø±ÙŠØ¯", "Ù…ÙˆØ¸Ù Ø§Ø³ØªÙ‚Ø¨Ø§Ù„", "Ø·Ø¨ÙŠØ¨ Ø¨ÙŠØ·Ø±ÙŠ", "Ø·Ø¨ÙŠØ¨ Ø£Ø³Ù†Ø§Ù†", "Ø·Ø¨ÙŠØ¨ Ø¹ÙŠÙˆÙ†", "Ù…Ø­Ù„Ù„ ÙƒÙˆØ±Ø©", "Ø³Ù…Ø³Ø§Ø±", "ØªØ§Ø¬Ø±", "Ù…Ù‚Ø§ÙˆÙ„", "Ø·ÙŠØ§Ø± Ø¯Ø±ÙˆÙ†"
        ],

        companies: [
            "Apple", "Google", "Microsoft", "Amazon", "Facebook", "Instagram", "WhatsApp", "YouTube", "TikTok", "Netflix",
            "Samsung", "Huawei", "Xiaomi", "Oppo", "Sony", "LG", "Dell", "HP", "Intel", "Canon",
            "Tesla", "Toyota", "Mercedes", "BMW", "Audi", "Ferrari", "Lamborghini", "Ford", "Chevrolet", "Jeep",
            "Nike", "Adidas", "Puma", "Zara", "H&M", "Gucci", "Prada", "Rolex", "Lacoste", "Chanel",
            "McDonald's", "KFC", "Burger King", "Pizza Hut", "Subway", "Starbucks", "Pepsi", "Coca-Cola", "Red Bull", "KitKat",
            "Disney", "Marvel", "DC Comics", "Warner Bros", "Paramount", "Pixar", "Universal", "Spotify", "Snapchat", "Telegram",
            "Visa", "Mastercard", "PayPal", "Binance", "Amazon", "eBay", "Alibaba", "AliExpress", "Shein", "Noon",
            "Uber", "Careem", "Airbnb", "Booking", "FedEx", "DHL", "Aramex", "IKEA", "Walmart", "Carrefour",
            "Nestle", "Dove", "Nivea", "L'Oreal", "Johnson's", "Colgate", "Gillette", "Rolex", "Casio", "Nikon",
            "Lego", "Barbie", "Hot Wheels", "PlayStation", "Xbox", "Nintendo", "Zoom", "Skype", "Slack", "LinkedIn"
        ]
    };

    let myName = "", myRoom = "", isHost = false;

    // --- Auto-fill name from localStorage ---
    document.addEventListener('DOMContentLoaded', () => {
        const savedName = localStorage.getItem('eljasus_user_name');
        const nameField = document.getElementById('pName');
        
        if (savedName && nameField) {
            nameField.value = savedName;
            myName = savedName; // Set the myName variable immediately
        }
        
        // Also check for special badges
        const userEmail = localStorage.getItem('eljasus_user_email');
        if (savedName === "AMG_Game owner" || userEmail === "ae8171889@gmail.com") {
            injectSpecialBadges();
        }
    });

    // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø«ÙŠÙ… ---
    window.updateLiveTheme = () => {
        const root = document.documentElement;
        root.style.setProperty('--bg-color', document.getElementById('colorBg').value);
        root.style.setProperty('--card-color', document.getElementById('colorCard').value);
        root.style.setProperty('--btn-color', document.getElementById('colorBtn').value);
        root.style.setProperty('--accent-color', document.getElementById('colorBtn').value);
        root.style.setProperty('--text-color', document.getElementById('colorText').value);
    };

    window.resetTheme = () => {
        document.getElementById('colorBg').value = "#080808";
        document.getElementById('colorCard').value = "#141414";
        document.getElementById('colorBtn').value = "#00f2ff";
        document.getElementById('colorText').value = "#ffffff";
        updateLiveTheme();
    };

    // --- ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ ---
    window.switchMode = (mode) => {
        document.getElementById('setLocal').classList.toggle('active', mode === 'local');
        document.getElementById('setOnline').classList.toggle('active', mode === 'online');
        document.getElementById('local-fields').classList.toggle('hidden', mode === 'online');
        document.getElementById('online-fields').classList.toggle('hidden', mode === 'local');
        if(mode === 'online') monitorPublicRooms();
    };

    // --- Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ù…Ø­Ù„ÙŠ ---
    let localPlayerCount = 3;
    window.changeLocalCount = (val) => {
        localPlayerCount = Math.max(3, Math.min(10, localPlayerCount + val));
        document.getElementById('localCountDisplay').innerText = localPlayerCount;
        renderLocalInputs();
    };

    function renderLocalInputs() {
        const container = document.getElementById('localNamesContainer');
        container.innerHTML = "";
        for(let i=1; i<=localPlayerCount; i++) {
            container.innerHTML += `<input type="text" class="local-name-in w-full bg-black/40 border border-white/5 p-3 rounded-xl text-xs text-center outline-none" value="Ù„Ø§Ø¹Ø¨ ${i}">`;
        }
    }
    renderLocalInputs();

    window.startLocalGame = () => {
        const names = Array.from(document.querySelectorAll('.local-name-in')).map(i => i.value || "Ù…Ø¬Ù‡ÙˆÙ„");
        const cat = document.getElementById('gameCat').value;
        const secret = gameData[cat][Math.floor(Math.random() * gameData[cat].length)];
        const spyIdx = Math.floor(Math.random() * names.length);
        showLocalTurn(names, secret, spyIdx, 0);
    };

    function showLocalTurn(names, secret, spyIdx, idx) {
        document.getElementById('setup-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        document.getElementById('targetPlayer').innerText = names[idx];
        const card = document.getElementById('secretCard');
        const btn = document.getElementById('nextBtn');
        
        card.classList.remove('reveal-spy', 'reveal-innocent');
        card.innerHTML = `<i class="fas fa-fingerprint text-6xl mb-4 opacity-20"></i><p class="font-bold opacity-50">Ø§Ù†Ù‚Ø± Ù„Ù„ÙƒØ´Ù ğŸ”’</p>`;
        btn.classList.add('hidden');

        card.onclick = () => {
            if(idx === spyIdx) {
                card.classList.add('reveal-spy');
                card.innerHTML = `<i class="fas fa-user-secret text-7xl mb-4"></i><h2 class="text-3xl font-black italic">Ø¬Ø§Ø³ÙˆØ³</h2>`;
            } else {
                card.classList.add('reveal-innocent');
                card.innerHTML = `<i class="fas fa-key text-5xl mb-4"></i><p class="text-[10px] opacity-70">Ø§Ù„ÙƒÙ„Ù…Ø©</p><h2 class="text-3xl font-black">${secret}</h2>`;
            }
            btn.classList.remove('hidden');
            card.onclick = null;
        };

        btn.onclick = () => {
            if(idx + 1 < names.length) showLocalTurn(names, secret, spyIdx, idx + 1);
            else location.reload();
        };
    }

    // --- Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ---
    function monitorPublicRooms() {
        onValue(ref(db, 'rooms'), (snap) => {
            const list = document.getElementById('publicRoomsList');
            list.innerHTML = "";
            const rooms = snap.val();
            if(!rooms) return;
            Object.keys(rooms).forEach(code => {
                const r = rooms[code];
                if(r.visibility === 'public' && r.status === 'waiting') {
                    const el = document.createElement('div');
                    el.className = "flex justify-between items-center bg-white/5 p-3 rounded-xl border border-white/5 cursor-pointer hover:dynamic-border-primary";
                    el.onclick = () => { myRoom = code; document.getElementById('joinBtn').click(); };
                    el.innerHTML = `<span class="text-xs font-bold text-cyan-400">${code}</span><span class="text-[10px] opacity-50">${r.players ? r.players.length : 0}/10 ğŸ‘¤</span>`;
                    list.appendChild(el);
                }
            });
        });
    }

    document.getElementById('createBtn').onclick = async () => {
        myName = document.getElementById('pName').value.trim();
        if(!myName) return alert("Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨");
        myRoom = Math.random().toString(36).substring(2, 6).toUpperCase();
        isHost = true;
        await set(ref(db, 'rooms/' + myRoom), { 
            host: myName, 
            status: 'waiting', 
            players: [myName], 
            turn: 0, 
            category: document.getElementById('gameCat').value, 
            visibility: 'private',
            secret: null,
            spyIdx: null,
            suspects: {},
            discussionMessages: [],
            readyForVote: [],
            votes: {},
            tiedPlayers: null,
            spyGuess: null,
            winner: null,
            votedPlayer: null
        });
        initRoom();
        setupPresence(myRoom, myName);
    };

    document.getElementById('joinBtn').onclick = async () => {
        myName = document.getElementById('pName').value.trim();
        if(!myName) return alert("Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨");
        if(!myRoom) myRoom = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©:").toUpperCase();
        const snap = await get(ref(db, 'rooms/' + myRoom));
        if(!snap.exists()) return alert("Ø§Ù„ØºØ±ÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©");
        const d = snap.val();
        if(!d.players.includes(myName)) {
            if(d.players.length >= 10) return alert("Ø§Ù„ØºØ±ÙØ© Ù…Ù…ØªÙ„Ø¦Ø©");
            await update(ref(db, 'rooms/' + myRoom), { players: [...d.players, myName] });
        }
        isHost = false;
        initRoom();
        setupPresence(myRoom, myName);
    };
    
    function setupPresence(roomCode, playerName) {
        const connectedRef = ref(db, ".info/connected");
        onValue(connectedRef, (snap) => {
            if (snap.val() === true) {
                const roomRef = ref(db, `rooms/${roomCode}`);

                onDisconnect(roomRef).get().then((snapshot) => {
                    if (snapshot.exists()) {
                        const data = snapshot.val();
                        
                        if (data.host === playerName) {
                            onDisconnect(roomRef).remove();
                        } else {
                            let updatedPlayers = data.players.map(p => 
                                p === playerName ? `${playerName} (Ø®Ø§Ù…Ù„)` : p
                            );
                            onDisconnect(ref(db, `rooms/${roomCode}/players`)).set(updatedPlayers);
                        }
                    }
                });
            }
        });
    }

    function hideAllGameScreens() {
        document.getElementById('game-screen').classList.add('hidden');
        document.getElementById('discussion-screen').classList.add('hidden');
        document.getElementById('voting-screen').classList.add('hidden');
        document.getElementById('tie-screen').classList.add('hidden');
        document.getElementById('spinner-screen').classList.add('hidden');
        document.getElementById('spy-guess-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.add('hidden');
        document.getElementById('room-overlay').classList.add('hidden');
    }

    function initRoom() {
        const roomRef = ref(db, 'rooms/' + myRoom);
        
        onValue(roomRef, (snap) => {
            const d = snap.val();
            if(!d) { 
                location.reload(); 
                return; 
            }

            if (d.players && d.players.includes(`${myName} (Ø®Ø§Ù…Ù„)`)) {
                let restoredPlayers = d.players.map(p => p === `${myName} (Ø®Ø§Ù…Ù„)` ? myName : p);
                update(ref(db, 'rooms/' + myRoom), { players: restoredPlayers });
                return;
            }
            
            if(!d.players.includes(myName)) {
                alert("ØªÙ… Ø·Ø±Ø¯Ùƒ Ù…Ù† Ø§Ù„ØºØ±ÙØ©");
                location.reload();
                return;
            }

            document.getElementById('displayRoomCode').innerText = myRoom;
            const pCount = d.players.length;
            document.getElementById('pCount').innerText = `${pCount}/10`;
            
            isHost = (d.host === myName);

            if(isHost) {
                document.getElementById('host-controls').classList.remove('hidden');
                document.getElementById('hostStartBtn').classList.remove('hidden');
                document.getElementById('guestWaitMsg').classList.add('hidden');
                
                const startBtn = document.getElementById('hostStartBtn');
                const msg = document.getElementById('minPlayersMsg');
                if(pCount >= 3) {
                    startBtn.disabled = false;
                    msg.classList.add('hidden');
                } else {
                    startBtn.disabled = true;
                    msg.classList.remove('hidden');
                }

                const vBtn = document.getElementById('toggleVisibility');
                vBtn.innerHTML = d.visibility === 'public' ? '<i class="fas fa-globe mr-1"></i> Ø¹Ø§Ù…' : '<i class="fas fa-lock mr-1"></i> Ø®Ø§Øµ';
                vBtn.className = d.visibility === 'public' ? "text-xs px-4 py-1 rounded-full border border-green-500 text-green-500" : "text-xs px-4 py-1 rounded-full border border-red-500 text-red-500";
            } else {
                document.getElementById('host-controls').classList.add('hidden');
                document.getElementById('hostStartBtn').classList.add('hidden');
                document.getElementById('guestWaitMsg').classList.remove('hidden');
                document.getElementById('minPlayersMsg').classList.add('hidden');
            }

            document.getElementById('roomPlayersList').innerHTML = d.players.map(p => {
                const isMe = (p === myName);
                const isTargetHost = (p === d.host);
                const isIdle = p.includes("(Ø®Ø§Ù…Ù„)");
                const displayName = p.replace("(Ø®Ø§Ù…Ù„)", "").trim();

                return `
                    <div class="flex justify-between items-center p-3 bg-white/5 rounded-xl border border-white/5 mb-2">
                        <div class="flex items-center gap-2">
                            <span class="text-xs">
                                ${isTargetHost ? 'ğŸ‘‘' : (isIdle ? 'ğŸ’¤' : 'ğŸ‘¤')} 
                            </span>
                            <span class="text-xs ${isIdle ? 'text-gray-500 italic' : 'text-white font-bold'}">
                                ${displayName} 
                                ${isIdle ? '<span class="text-[10px] ml-1 opacity-60 text-gray-500">(Ø®Ø§Ù…Ù„)</span>' : ''}
                                ${isMe ? '<span class="text-[10px] text-cyan-400 ml-1">(Ø£Ù†Øª)</span>' : ''}
                            </span>
                        </div>
                        
                        ${isHost && !isMe ? `
                            <button onclick="kickPlayer('${p}')" 
                                class="text-[10px] bg-red-600 text-white px-3 py-1 rounded-lg font-bold shadow-lg hover:bg-red-700 active:scale-95 transition-all">
                                Ø·Ø±Ø¯
                            </button>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            if(d.status && d.status !== 'waiting') {
                hideAllGameScreens();
                if(d.status === 'playing') showOnlineGame(d);
                else if(d.status === 'discussion') showDiscussionScreen(d);
                else if(d.status === 'voting') showVotingScreen(d);
                else if(d.status === 'tie') showTieScreen(d);
                else if(d.status === 'spinner') showSpinnerScreen(d);
                else if(d.status === 'spy_guess') showSpyGuessScreen(d);
                else if(d.status === 'result') showResultScreen(d);
            } else { 
                hideAllGameScreens();
                document.getElementById('room-overlay').classList.remove('hidden');
            }
        });
    }

    async function handleLeave(data, nameToLeave) {
        let players = data.players.filter(p => p !== nameToLeave);
        if(players.length === 0) {
            await remove(ref(db, 'rooms/' + myRoom));
        } else {
            let updates = { players: players };
            if(data.host === nameToLeave) {
                updates.host = players[Math.floor(Math.random() * players.length)];
            }
            await update(ref(db, 'rooms/' + myRoom), updates);
        }
    }

    window.kickPlayer = async (targetName) => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        if(snap.exists()) {
            const d = snap.val();
            const newPlayers = d.players.filter(p => p !== targetName);
            await update(ref(db, 'rooms/' + myRoom), { players: newPlayers });
        }
    };

    document.getElementById('leaveRoomBtn').onclick = async () => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        if(snap.exists()) {
            await handleLeave(snap.val(), myName);
        }
        location.reload();
    };

    window.toggleRoomVisibility = async () => {
        const s = await get(ref(db, 'rooms/' + myRoom));
        update(ref(db, 'rooms/' + myRoom), { visibility: s.val().visibility === 'private' ? 'public' : 'private' });
    };

    window.updateRoomSettings = () => {
        update(ref(db, 'rooms/' + myRoom), { category: document.getElementById('updateCat').value });
    };

    document.getElementById('hostStartBtn').onclick = async () => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        
        if(d.status && d.status !== 'waiting') {
            alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©");
            return;
        }
        
        const secret = gameData[d.category][Math.floor(Math.random() * gameData[d.category].length)];
        update(ref(db, 'rooms/' + myRoom), { 
            status: 'playing', 
            secret: secret, 
            spyIdx: Math.floor(Math.random() * d.players.length), 
            turn: 0,
            suspects: {},
            discussionMessages: [],
            readyForVote: [],
            votes: {},
            tiedPlayers: null,
            spyGuess: null,
            winner: null,
            votedPlayer: null
        });
    };

    // ==============================================
    // GAME PHASES FUNCTIONS
    // ==============================================

    function showOnlineGame(d) {
        hideAllGameScreens();
        document.getElementById('game-screen').classList.remove('hidden');
        const isMyTurn = d.players[d.turn] === myName;
        document.getElementById('targetPlayer').innerText = d.players[d.turn];
        
        const card = document.getElementById('secretCard');
        const btn = document.getElementById('nextBtn');
        card.classList.remove('reveal-spy', 'reveal-innocent');
        card.innerHTML = `<i class="fas fa-fingerprint text-6xl mb-4 opacity-20"></i><p class="font-bold opacity-50">Ø§Ù†Ù‚Ø± Ù„Ù„ÙƒØ´Ù ğŸ”’</p>`;
        card.style.pointerEvents = isMyTurn ? "auto" : "none";
        btn.classList.add('hidden');

        card.onclick = () => {
            if(d.players.indexOf(myName) === d.spyIdx) {
                card.classList.add('reveal-spy');
                card.innerHTML = `<i class="fas fa-user-secret text-7xl mb-4"></i><h2 class="text-3xl font-black italic">Ø¬Ø§Ø³ÙˆØ³</h2>`;
            } else {
                card.classList.add('reveal-innocent');
                card.innerHTML = `<i class="fas fa-key text-5xl mb-4"></i><h2 class="text-3xl font-black">${d.secret}</h2>`;
            }
            btn.classList.remove('hidden');
            card.onclick = null;
        };

        btn.onclick = () => {
            if(d.turn + 1 >= d.players.length) {
                update(ref(db, 'rooms/' + myRoom), { 
                    status: 'discussion',
                    suspects: {},
                    discussionMessages: [],
                    readyForVote: [],
                    votes: {}
                });
            } else {
                update(ref(db, 'rooms/' + myRoom), { turn: d.turn + 1 });
            }
        };
    }

    function showDiscussionScreen(d) {
        hideAllGameScreens();
        document.getElementById('discussion-screen').classList.remove('hidden');
        
        const suspectsList = document.getElementById('suspectsList');
        suspectsList.innerHTML = d.players.map(p => {
            const suspectCount = d.suspects && d.suspects[p] ? d.suspects[p].length : 0;
            const isSuspect = d.suspects && d.suspects[p] && d.suspects[p].includes(myName);
            return `
                <div class="glass rounded-2xl p-4 border ${isSuspect ? 'border-red-500' : 'border-white/10'} text-center">
                    <div class="text-2xl mb-2">${p === d.host ? 'ğŸ‘‘' : 'ğŸ‘¤'}</div>
                    <h3 class="font-black text-sm mb-2">${p}</h3>
                    <div class="text-xs opacity-60 mb-3">${suspectCount} Ø´Ø®Øµ ÙŠØ´Ùƒ Ø¨Ù‡</div>
                    <button onclick="toggleSuspect('${p}')" class="${isSuspect ? 'bg-red-600' : 'bg-white/10'} w-full py-2 rounded-lg text-xs font-bold transition-all">
                        ${isSuspect ? 'Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ùƒ âŒ' : 'Ø£Ø´Ùƒ Ø¨Ù‡ ğŸ”'}
                    </button>
                </div>
            `;
        }).join('');

        if(d.discussionMessages) {
            const messagesDiv = document.getElementById('discussionMessages');
            messagesDiv.innerHTML = d.discussionMessages.map(m => 
                `<div class="mb-2"><span class="font-bold text-cyan-400">${m.player}:</span> ${m.msg}</div>`
            ).join('');
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        const readyCount = d.readyForVote ? d.readyForVote.length : 0;
        document.getElementById('discussionInfo').innerText = `${readyCount}/${d.players.length} Ù„Ø§Ø¹Ø¨ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØµÙˆÙŠØª`;
        
        const goVoteBtn = document.getElementById('goVoteBtn');
        const isReady = d.readyForVote && d.readyForVote.includes(myName);
        goVoteBtn.innerText = isReady ? 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†... â³' : 'Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØµÙˆÙŠØª âœ…';
        goVoteBtn.disabled = isReady;
        goVoteBtn.onclick = () => markReadyForVote();
    }

    window.toggleSuspect = async (targetPlayer) => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        let suspects = d.suspects || {};
        
        if(!suspects[targetPlayer]) suspects[targetPlayer] = [];
        
        if(suspects[targetPlayer].includes(myName)) {
            suspects[targetPlayer] = suspects[targetPlayer].filter(p => p !== myName);
        } else {
            suspects[targetPlayer].push(myName);
        }
        
        update(ref(db, 'rooms/' + myRoom), { suspects });
    };

    async function markReadyForVote() {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        let ready = d.readyForVote || [];
        
        if(!ready.includes(myName)) {
            ready.push(myName);
            await update(ref(db, 'rooms/' + myRoom), { readyForVote: ready });
        }
        
        if(ready.length >= d.players.length) {
            await update(ref(db, 'rooms/' + myRoom), { 
                status: 'voting',
                votes: {}
            });
        }
    }

    document.getElementById('toggleChatBtn').onclick = () => {
        document.getElementById('chatWindow').classList.toggle('hidden');
    };

    document.getElementById('closeChatBtn').onclick = () => {
        document.getElementById('chatWindow').classList.add('hidden');
    };

    document.getElementById('sendDiscussionBtn').onclick = async () => {
        const input = document.getElementById('discussionInput');
        const msg = input.value.trim();
        if(!msg) return;
        
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        let messages = d.discussionMessages || [];
        messages.push({ player: myName, msg: msg });
        
        await update(ref(db, 'rooms/' + myRoom), { discussionMessages: messages });
        input.value = '';
    };

    document.getElementById('discussionInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            document.getElementById('sendDiscussionBtn').click();
        }
    });

    function showVotingScreen(d) {
        hideAllGameScreens();
        document.getElementById('voting-screen').classList.remove('hidden');
        
        const hasVoted = d.votes && d.votes[myName];
        const voteCards = document.getElementById('voteCards');
        
        voteCards.innerHTML = d.players.map(p => {
            const voteCount = Object.values(d.votes || {}).filter(v => v === p).length;
            const isMyVote = d.votes && d.votes[myName] === p;
            return `
                <div class="glass rounded-2xl p-4 border ${isMyVote ? 'border-yellow-500' : 'border-white/10'} text-center ${hasVoted ? 'opacity-50' : ''}">
                    <div class="text-3xl mb-2">${p === d.host ? 'ğŸ‘‘' : 'ğŸ‘¤'}</div>
                    <h3 class="font-black text-sm mb-2">${p}</h3>
                    <div class="text-xs opacity-60 mb-3">${voteCount} ØµÙˆØª</div>
                    <button onclick="castVote('${p}')" ${hasVoted ? 'disabled' : ''} class="bg-yellow-600 disabled:bg-gray-600 w-full py-2 rounded-lg text-xs font-bold">
                        ${isMyVote ? 'ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª âœ“' : 'ØµÙˆÙ‘Øª ğŸ—³ï¸'}
                    </button>
                </div>
            `;
        }).join('');

        const votedCount = Object.keys(d.votes || {}).length;
        document.getElementById('votingStatus').innerText = `${votedCount}/${d.players.length} Ù„Ø§Ø¹Ø¨ Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØµÙˆÙŠØª`;
    }

    window.castVote = async (targetPlayer) => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        
        if(d.votes && d.votes[myName]) return;
        
        let votes = d.votes || {};
        votes[myName] = targetPlayer;
        
        await update(ref(db, 'rooms/' + myRoom), { votes });
        
        if(Object.keys(votes).length >= d.players.length) {
            processVotes(d, votes);
        }
    };

    async function processVotes(d, votes) {
        const voteCounts = {};
        d.players.forEach(p => voteCounts[p] = 0);
        Object.values(votes).forEach(v => voteCounts[v]++);
        
        const maxVotes = Math.max(...Object.values(voteCounts));
        const topVoted = Object.keys(voteCounts).filter(p => voteCounts[p] === maxVotes);
        
        if(topVoted.length > 1) {
            await update(ref(db, 'rooms/' + myRoom), { 
                status: 'tie',
                tiedPlayers: topVoted
            });
            setTimeout(async () => {
                await update(ref(db, 'rooms/' + myRoom), { status: 'spinner' });
            }, 2000);
        } else {
            checkGameResult(d, topVoted[0]);
        }
    }

    function showTieScreen(d) {
        hideAllGameScreens();
        document.getElementById('tie-screen').classList.remove('hidden');
        
        setTimeout(() => {
            document.getElementById('tie-screen').classList.add('hidden');
        }, 2000);
    }

    function showSpinnerScreen(d) {
        hideAllGameScreens();
        document.getElementById('spinner-screen').classList.remove('hidden');
        
        const spinnerContent = document.getElementById('spinnerContent');
        const startBtn = document.getElementById('startSpinnerBtn');
        
        startBtn.onclick = async () => {
            startBtn.disabled = true;
            let index = 0;
            const interval = setInterval(() => {
                spinnerContent.innerText = d.tiedPlayers[index % d.tiedPlayers.length];
                index++;
            }, 100);
            
            setTimeout(async () => {
                clearInterval(interval);
                const selected = d.tiedPlayers[Math.floor(Math.random() * d.tiedPlayers.length)];
                spinnerContent.innerText = selected;
                
                setTimeout(async () => {
                    await checkGameResult(d, selected);
                }, 1500);
            }, 3000);
        };
    }

    async function checkGameResult(d, votedPlayer) {
        const spyName = d.players[d.spyIdx];
        
        if(votedPlayer === spyName) {
            await update(ref(db, 'rooms/' + myRoom), { 
                status: 'spy_guess',
                votedPlayer: spyName
            });
        } else {
            await update(ref(db, 'rooms/' + myRoom), { 
                status: 'result',
                winner: 'spy',
                spyName: spyName
            });
        }
    }

    function showSpyGuessScreen(d) {
        hideAllGameScreens();
        document.getElementById('spy-guess-screen').classList.remove('hidden');
        
        const spyName = d.players[d.spyIdx];
        document.getElementById('spyNameDisplay').innerText = `Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ù‡Ùˆ: ${spyName}`;
        
        const categoryWords = gameData[d.category];
        const wordsList = document.getElementById('categoryWordsList');
        
        const isSpy = myName === spyName;
        const hasGuessed = d.spyGuess !== undefined;
        
        wordsList.innerHTML = categoryWords.map(word => `
            <button onclick="spyGuessWord('${word}')" ${!isSpy || hasGuessed ? 'disabled' : ''} 
                class="glass rounded-xl p-3 border border-white/10 font-bold text-sm hover:border-cyan-500 disabled:opacity-30 transition-all">
                ${word}
            </button>
        `).join('');
        
        if(hasGuessed) {
            const correct = d.spyGuess === d.secret;
            document.getElementById('guessResult').innerHTML = correct ? 
                '<span class="text-green-500">âœ“ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</span>' : 
                '<span class="text-red-500">âœ— Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©!</span>';
        }
    }

    window.spyGuessWord = async (word) => {
        const snap = await get(ref(db, 'rooms/' + myRoom));
        const d = snap.val();
        
        const correct = word === d.secret;
        
        await update(ref(db, 'rooms/' + myRoom), { 
            spyGuess: word,
            status: 'result',
            winner: correct ? 'spy' : 'innocents',
            spyName: d.players[d.spyIdx]
        });
    };

    function showResultScreen(d) {
        hideAllGameScreens();
        document.getElementById('result-screen').classList.remove('hidden');
        
        const icon = document.getElementById('resultIcon');
        const title = document.getElementById('resultTitle');
        const message = document.getElementById('resultMessage');
        
        if(d.winner === 'spy') {
            icon.innerText = 'ğŸ•µï¸';
            title.innerText = 'Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø§Ù†ØªØµØ±!';
            message.innerText = `${d.spyName} Ù†Ø¬Ø­ ÙÙŠ Ø§Ù„Ù…Ù‡Ù…Ø©!`;
        } else {
            icon.innerText = 'ğŸ†';
            title.innerText = 'Ø§Ù„Ø£Ø¨Ø±ÙŠØ§Ø¡ Ø§Ù†ØªØµØ±ÙˆØ§!';
            message.innerText = `ØªÙ… ÙƒØ´Ù Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ ${d.spyName}!`;
        }
        
        document.getElementById('returnToRoomBtn').onclick = async () => {
            hideAllGameScreens();
            
            await update(ref(db, 'rooms/' + myRoom), { 
                status: 'waiting',
                turn: 0,
                secret: null,
                spyIdx: null,
                suspects: {},
                discussionMessages: [],
                readyForVote: [],
                votes: {},
                tiedPlayers: null,
                spyGuess: null,
                winner: null,
                votedPlayer: null
            });
            
            document.getElementById('room-overlay').classList.remove('hidden');
        };
    }

    document.getElementById('roomCodeContainer').onclick = () => {
        navigator.clipboard.writeText(myRoom);
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯!");
    };

    resetTheme();

    // Firebase Auth
    const auth = firebase.auth();

    auth.onAuthStateChanged((user) => {
        if (user) {
            if (user.email === 'ae8171889@gmail.com') {
                const badgeContainer = document.getElementById('user-badges');
                const nameDisplay = document.getElementById('nav-username');

                if (nameDisplay) {
                    nameDisplay.innerHTML = `
                        AHMED AL GOHARY 
                        <span class="admin-tag owner-tag">Owner</span>
                        <span class="admin-tag dev-tag">Developer</span>
                    `;
                }

                if (badgeContainer) {
                    badgeContainer.innerHTML = `
                        <i class="fas fa-crown text-yellow-500 ml-2 drop-shadow-[0_0_8px_rgba(234,179,8,0.8)]"></i>
                        <i class="fas fa-laptop-code text-blue-400 ml-2"></i>
                    `;
                }
            }
        }
    });

    function injectSpecialBadges() {
        const nameContainers = document.querySelectorAll('.player-name-text');
        nameContainers.forEach(container => {
            if (!container.querySelector('.fa-crown')) {
                container.innerHTML += `
                    <i class="fas fa-crown text-yellow-500 ml-1 drop-shadow-[0_0_5px_rgba(255,214,0,0.7)] animate-pulse" title="Owner"></i>
                    <i class="fas fa-laptop-code text-blue-400 ml-1" title="Developer"></i>
                `;
            }
        });
    }

    // Logout functionality
    document.addEventListener('DOMContentLoaded', function() {
        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', async function() {
                try {
                    await auth.signOut();
                    localStorage.removeItem('eljasus_user_name');
                    localStorage.removeItem('eljasus_user_email');
                    
                    const nameField = document.getElementById('pName');
                    if (nameField) nameField.value = "";
                    
                    console.log("Logged out successfully!");
                    
                    setTimeout(() => {
                        window.location.href = "login.html";
                    }, 500);
                    
                } catch(error) {
                    console.error("Logout error:", error);
                    alert("Logout failed: " + error.message);
                }
            });
        }
    });
</script>
    <footer class="mt-20 border-t border-cyan-900/50 bg-black/40 backdrop-blur-md pt-12 pb-6">
    <div class="max-w-6xl mx-auto px-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-12">
            
            <div class="space-y-4 text-center md:text-right">
                <div class="flex items-center justify-center md:justify-start gap-3">
                    <i class="fas fa-dragon text-3xl text-cyan-400 drop-shadow-[0_0_8px_#00f2ff]"></i>
                    <a href="https://ahmedelgoharymessi-dot.github.io/PhineX.github.io/"><span class="text-2xl font-black tracking-tighter text-white uppercase italic">PhineX</span></a>
                </div>
                <p class="text-gray-400 font-bold text-sm leading-relaxed max-w-xs mx-auto md:mx-0">
                    Ù†Ø®Ø¨Ø© Ù…Ù† Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ÙŠÙ† Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ† Ù„ØµÙ†Ø§Ø¹Ø© ØªØ¬Ø§Ø±Ø¨ Ø±Ù‚Ù…ÙŠØ© Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©.
                </p>
            </div>

            <div class="space-y-6 text-center md:text-left">
                <h4 class="text-[10px] font-black text-cyan-500 uppercase tracking-[0.3em]">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h4>
                <div class="flex flex-wrap justify-center md:justify-end gap-4">
                    <a href="https://discord.gg/xBQ3ewVVHk" target="_blank" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-[#5865F2] hover:border-[#5865F2] hover:shadow-[0_0_15px_#5865F2] transition-all duration-300">
                        <i class="fab fa-discord text-xl"></i>
                    </a>
                    <a href="https://github.com/ahmedelgoharymessi-dot" target="_blank" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-white hover:border-white hover:shadow-[0_0_15px_rgba(255,255,255,0.5)] transition-all duration-300">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                    <a href="https://www.youtube.com/channel/UCslNCf9VtxpFH_gtA1VHFyQ" target="_blank" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-[#FF0000] hover:border-[#FF0000] hover:shadow-[0_0_15px_#FF0000] transition-all duration-300">
                        <i class="fab fa-youtube text-xl"></i>
                    </a>
                    <a href="https://chat.whatsapp.com/IuC3Gu6x5p61MORTnAuHJA" target="_blank" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-[#25D366] hover:border-[#25D366] hover:shadow-[0_0_15px_#25D366] transition-all duration-300">
                        <i class="fab fa-whatsapp text-xl"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=61584765330775" target="_blank" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-[#1877F2] hover:border-[#1877F2] hover:shadow-[0_0_15px_#1877F2] transition-all duration-300">
                        <i class="fab fa-facebook-f text-xl"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="border-t border-white/5 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-[11px] font-bold text-gray-500 uppercase tracking-widest">
            <p>&copy; 2026 <a href="https://ahmedelgoharymessi-dot.github.io/PhineX.github.io/"<span class="text-cyan-500">PhineX</span>. All rights reserved.</p>
            
            <div class="flex items-center gap-2 text-[11px] font-bold text-gray-500 uppercase tracking-widest group">
            <span>Made with</span>
            <i class="fas fa-heart text-red-600 animate-pulse mx-1"></i>
            <span>By :</span>
            <a href="https://www.facebook.com/A.Mo.Elgohary/" target="_blank" class="flex items-center gap-1.5 text-cyan-500 hover:text-white transition-all duration-300">
                <i class="fas fa-laptop-code text-[14px]"></i>
                <span class="underline decoration-cyan-900 underline-offset-4 group-hover:decoration-cyan-500">@Ahmed Al Gohary</span>
            </a>
        </div>
    </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Check if we have a name saved from the Login/Signup process
        const savedName = localStorage.getItem('eljasus_user_name');
        
        // 2. Find the element that currently says "Agent"
        // Replace '.agent-class' with the actual class or ID of your name display
        const nameDisplay = document.querySelector('.text-cyan-500'); 

        if (savedName && nameDisplay) {
            // 3. Change "Agent" to the real Username
            nameDisplay.innerText = savedName;
        }
    });

    setInterval(() => {
    const discordIcon = document.querySelector('.animate-discord');
    if (discordIcon) {
        discordIcon.classList.add('discord-trigger');
        setTimeout(() => {
            discordIcon.classList.remove('discord-trigger');
        }, 500); // ÙŠØªÙˆÙ‚Ù Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø² Ø¨Ø¹Ø¯ Ù†ØµÙ Ø«Ø§Ù†ÙŠØ©
    }
}, 3000); // ÙŠØªÙƒØ±Ø± ÙƒÙ„ 5 Ø«ÙˆØ§Ù†Ù

function showOnlineGame(d) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
            if(d.status === 'discussion') {
                showDiscussionScreen(d);
                return;
            }
            if(d.status === 'voting') {
                showVotingScreen(d);
                return;
            }
            if(d.status === 'tie') {
                showTieScreen(d);
                return;
            }
            if(d.status === 'spinner') {
                showSpinnerScreen(d);
                return;
            }
            if(d.status === 'spy_guess') {
                showSpyGuessScreen(d);
                return;
            }
            if(d.status === 'result') {
                showResultScreen(d);
                return;
            }

            document.getElementById('room-overlay').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            const isMyTurn = d.players[d.turn] === myName;
            document.getElementById('targetPlayer').innerText = d.players[d.turn];
            
            const card = document.getElementById('secretCard');
            const btn = document.getElementById('nextBtn');
            card.classList.remove('reveal-spy', 'reveal-innocent');
            card.innerHTML = `<i class="fas fa-fingerprint text-6xl mb-4 opacity-20"></i><p class="font-bold opacity-50">Ø§Ù†Ù‚Ø± Ù„Ù„ÙƒØ´Ù ğŸ”’</p>`;
            card.style.pointerEvents = isMyTurn ? "auto" : "none";
            btn.classList.add('hidden');

            card.onclick = () => {
                if(d.players.indexOf(myName) === d.spyIdx) {
                    card.classList.add('reveal-spy');
                    card.innerHTML = `<i class="fas fa-user-secret text-7xl mb-4"></i><h2 class="text-3xl font-black italic">Ø¬Ø§Ø³ÙˆØ³</h2>`;
                } else {
                    card.classList.add('reveal-innocent');
                    card.innerHTML = `<i class="fas fa-key text-5xl mb-4"></i><h2 class="text-3xl font-black">${d.secret}</h2>`;
                }
                btn.classList.remove('hidden');
                card.onclick = null;
            };

            // Add this function to your existing code, preferably near the showOnlineGame function
function showOnlineGame(d) {
    // Check game status and show appropriate screen
    if(d.status === 'discussion') {
        showDiscussionScreen(d);
        return;
    }
    if(d.status === 'voting') {
        showVotingScreen(d);
        return;
    }
    if(d.status === 'tie') {
        showTieScreen(d);
        return;
    }
    if(d.status === 'spinner') {
        showSpinnerScreen(d);
        return;
    }
    if(d.status === 'spy_guess') {
        showSpyGuessScreen(d);
        return;
    }
    if(d.status === 'result') {
        showResultScreen(d);
        return;
    }

    // Original game screen logic
    document.getElementById('room-overlay').classList.add('hidden');
    document.getElementById('game-screen').classList.remove('hidden');
    const isMyTurn = d.players[d.turn] === myName;
    document.getElementById('targetPlayer').innerText = d.players[d.turn];
    
    const card = document.getElementById('secretCard');
    const btn = document.getElementById('nextBtn');
    card.classList.remove('reveal-spy', 'reveal-innocent');
    card.innerHTML = `<i class="fas fa-fingerprint text-6xl mb-4 opacity-20"></i><p class="font-bold opacity-50">Ø§Ù†Ù‚Ø± Ù„Ù„ÙƒØ´Ù ğŸ”’</p>`;
    card.style.pointerEvents = isMyTurn ? "auto" : "none";
    btn.classList.add('hidden');

    card.onclick = () => {
        if(d.players.indexOf(myName) === d.spyIdx) {
            card.classList.add('reveal-spy');
            card.innerHTML = `<i class="fas fa-user-secret text-7xl mb-4"></i><h2 class="text-3xl font-black italic">Ø¬Ø§Ø³ÙˆØ³</h2>`;
        } else {
            card.classList.add('reveal-innocent');
            card.innerHTML = `<i class="fas fa-key text-5xl mb-4"></i><h2 class="text-3xl font-black">${d.secret}</h2>`;
        }
        btn.classList.remove('hidden');
        card.onclick = null;
    };

    btn.onclick = () => {
        if(d.turn + 1 >= d.players.length) {
            // Move to discussion phase
            update(ref(db, 'rooms/' + myRoom), { 
                status: 'discussion',
                suspects: {},
                discussionMessages: [],
                readyForVote: []
            });
        } else {
            update(ref(db, 'rooms/' + myRoom), { turn: d.turn + 1 });
        }
    };
}

// Discussion Phase
function showDiscussionScreen(d) {
    document.getElementById('game-screen').classList.add('hidden');
    document.getElementById('room-overlay').classList.add('hidden');
    document.getElementById('discussion-screen').classList.remove('hidden');
    
    // Update suspects list
    const suspectsList = document.getElementById('suspectsList');
    suspectsList.innerHTML = d.players.map(p => {
        const suspectCount = d.suspects && d.suspects[p] ? d.suspects[p].length : 0;
        const isSuspect = d.suspects && d.suspects[p] && d.suspects[p].includes(myName);
        return `
            <div class="glass rounded-2xl p-4 border ${isSuspect ? 'border-red-500' : 'border-white/10'} text-center">
                <div class="text-2xl mb-2">${p === d.host ? 'ğŸ‘‘' : 'ğŸ‘¤'}</div>
                <h3 class="font-black text-sm mb-2">${p}</h3>
                <div class="text-xs opacity-60 mb-3">${suspectCount} Ø´Ø®Øµ ÙŠØ´Ùƒ Ø¨Ù‡</div>
                <button onclick="toggleSuspect('${p}')" class="${isSuspect ? 'bg-red-600' : 'bg-white/10'} w-full py-2 rounded-lg text-xs font-bold transition-all">
                    ${isSuspect ? 'Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ùƒ âŒ' : 'Ø£Ø´Ùƒ Ø¨Ù‡ ğŸ”'}
                </button>
            </div>
        `;
    }).join('');

    // Update chat messages
    if(d.discussionMessages) {
        const messagesDiv = document.getElementById('discussionMessages');
        messagesDiv.innerHTML = d.discussionMessages.map(m => 
            `<div class="mb-2"><span class="font-bold text-cyan-400">${m.player}:</span> ${m.msg}</div>`
        ).join('');
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    // Update ready count
    const readyCount = d.readyForVote ? d.readyForVote.length : 0;
    document.getElementById('discussionInfo').innerText = `${readyCount}/${d.players.length} Ù„Ø§Ø¹Ø¨ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØµÙˆÙŠØª`;
    
    const goVoteBtn = document.getElementById('goVoteBtn');
    const isReady = d.readyForVote && d.readyForVote.includes(myName);
    goVoteBtn.innerText = isReady ? 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†... â³' : 'Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØµÙˆÙŠØª âœ…';
    goVoteBtn.disabled = isReady;
    goVoteBtn.onclick = () => markReadyForVote();
}

// Toggle suspect function
window.toggleSuspect = async (targetPlayer) => {
    const snap = await get(ref(db, 'rooms/' + myRoom));
    const d = snap.val();
    let suspects = d.suspects || {};
    
    if(!suspects[targetPlayer]) suspects[targetPlayer] = [];
    
    if(suspects[targetPlayer].includes(myName)) {
        suspects[targetPlayer] = suspects[targetPlayer].filter(p => p !== myName);
    } else {
        suspects[targetPlayer].push(myName);
    }
    
    update(ref(db, 'rooms/' + myRoom), { suspects });
};

// Mark ready for vote
async function markReadyForVote() {
    const snap = await get(ref(db, 'rooms/' + myRoom));
    const d = snap.val();
    let ready = d.readyForVote || [];
    
    if(!ready.includes(myName)) {
        ready.push(myName);
        await update(ref(db, 'rooms/' + myRoom), { readyForVote: ready });
    }
    
    if(ready.length >= d.players.length) {
        await update(ref(db, 'rooms/' + myRoom), { 
            status: 'voting',
            votes: {}
        });
    }
}

// Chat functionality
document.getElementById('toggleChatBtn').onclick = () => {
    document.getElementById('chatWindow').classList.toggle('hidden');
};

document.getElementById('closeChatBtn').onclick = () => {
    document.getElementById('chatWindow').classList.add('hidden');
};

document.getElementById('sendDiscussionBtn').onclick = async () => {
    const input = document.getElementById('discussionInput');
    const msg = input.value.trim();
    if(!msg) return;
    
    const snap = await get(ref(db, 'rooms/' + myRoom));
    const d = snap.val();
    let messages = d.discussionMessages || [];
    messages.push({ player: myName, msg: msg });
    
    await update(ref(db, 'rooms/' + myRoom), { discussionMessages: messages });
    input.value = '';
};

// Voting Phase
function showVotingScreen(d) {
    document.getElementById('discussion-screen').classList.add('hidden');
    document.getElementById('voting-screen').classList.remove('hidden');
    
    const hasVoted = d.votes && d.votes[myName];
    const voteCards = document.getElementById('voteCards');
    
    voteCards.innerHTML = d.players.map(p => {
        const voteCount = Object.values(d.votes || {}).filter(v => v === p).length;
        const isMyVote = d.votes && d.votes[myName] === p;
        return `
            <div class="glass rounded-2xl p-4 border ${isMyVote ? 'border-yellow-500' : 'border-white/10'} text-center ${hasVoted ? 'opacity-50' : ''}">
                <div class="text-3xl mb-2">${p === d.host ? 'ğŸ‘‘' : 'ğŸ‘¤'}</div>
                <h3 class="font-black text-sm mb-2">${p}</h3>
                <div class="text-xs opacity-60 mb-3">${voteCount} ØµÙˆØª</div>
                <button onclick="castVote('${p}')" ${hasVoted ? 'disabled' : ''} class="bg-yellow-600 disabled:bg-gray-600 w-full py-2 rounded-lg text-xs font-bold">
                    ${isMyVote ? 'ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª âœ“' : 'ØµÙˆÙ‘Øª ğŸ—³ï¸'}
                </button>
            </div>
        `;
    }).join('');

    const votedCount = Object.keys(d.votes || {}).length;
    document.getElementById('votingStatus').innerText = `${votedCount}/${d.players.length} Ù„Ø§Ø¹Ø¨ Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØµÙˆÙŠØª`;
}

// Cast vote function
window.castVote = async (targetPlayer) => {
    const snap = await get(ref(db, 'rooms/' + myRoom));
    const d = snap.val();
    
    if(d.votes && d.votes[myName]) return;
    
    let votes = d.votes || {};
    votes[myName] = targetPlayer;
    
    await update(ref(db, 'rooms/' + myRoom), { votes });
    
    if(Object.keys(votes).length >= d.players.length) {
        processVotes(d, votes);
    }
};

// Process votes and determine winner
async function processVotes(d, votes) {
    const voteCounts = {};
    d.players.forEach(p => voteCounts[p] = 0);
    Object.values(votes).forEach(v => voteCounts[v]++);
    
    const maxVotes = Math.max(...Object.values(voteCounts));
    const topVoted = Object.keys(voteCounts).filter(p => voteCounts[p] === maxVotes);
    
    if(topVoted.length > 1) {
        // Tie - show tie screen then spinner
        await update(ref(db, 'rooms/' + myRoom), { 
            status: 'tie',
            tiedPlayers: topVoted
        });
        setTimeout(async () => {
            await update(ref(db, 'rooms/' + myRoom), { status: 'spinner' });
        }, 2000);
    } else {
        checkGameResult(d, topVoted[0]);
    }
}

// Tie Screen
function showTieScreen(d) {
    document.getElementById('voting-screen').classList.add('hidden');
    document.getElementById('tie-screen').classList.remove('hidden');
    
    setTimeout(() => {
        document.getElementById('tie-screen').classList.add('hidden');
    }, 2000);
}

// Spinner Screen for tie-breaking
function showSpinnerScreen(d) {
    document.getElementById('tie-screen').classList.add('hidden');
    document.getElementById('spinner-screen').classList.remove('hidden');
    
    const spinnerContent = document.getElementById('spinnerContent');
    const startBtn = document.getElementById('startSpinnerBtn');
    
    startBtn.onclick = async () => {
        startBtn.disabled = true;
        let index = 0;
        const interval = setInterval(() => {
            spinnerContent.innerText = d.tiedPlayers[index % d.tiedPlayers.length];
            index++;
        }, 100);
        
        setTimeout(async () => {
            clearInterval(interval);
            const selected = d.tiedPlayers[Math.floor(Math.random() * d.tiedPlayers.length)];
            spinnerContent.innerText = selected;
            
            setTimeout(async () => {
                await checkGameResult(d, selected);
            }, 1500);
        }, 3000);
    };
}

// Check game result after voting
async function checkGameResult(d, votedPlayer) {
    const spyName = d.players[d.spyIdx];
    
    if(votedPlayer === spyName) {
        await update(ref(db, 'rooms/' + myRoom), { 
            status: 'spy_guess',
            votedPlayer: spyName
        });
    } else {
        await update(ref(db, 'rooms/' + myRoom), { 
            status: 'result',
            winner: 'spy',
            spyName: spyName
        });
    }
}

// Spy Guess Screen
function showSpyGuessScreen(d) {
    document.getElementById('spinner-screen').classList.add('hidden');
    document.getElementById('voting-screen').classList.add('hidden');
    document.getElementById('spy-guess-screen').classList.remove('hidden');
    
    const spyName = d.players[d.spyIdx];
    document.getElementById('spyNameDisplay').innerText = `Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ù‡Ùˆ: ${spyName}`;
    
    const categoryWords = gameData[d.category];
    const wordsList = document.getElementById('categoryWordsList');
    
    const isSpy = myName === spyName;
    const hasGuessed = d.spyGuess !== undefined;
    
    wordsList.innerHTML = categoryWords.map(word => `
        <button onclick="spyGuessWord('${word}')" ${!isSpy || hasGuessed ? 'disabled' : ''} 
            class="glass rounded-xl p-3 border border-white/10 font-bold text-sm hover:border-cyan-500 disabled:opacity-30 transition-all">
            ${word}
        </button>
    `).join('');
    
    if(hasGuessed) {
        const correct = d.spyGuess === d.secret;
        document.getElementById('guessResult').innerHTML = correct ? 
            '<span class="text-green-500">âœ“ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</span>' : 
            '<span class="text-red-500">âœ— Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©!</span>';
    }
}

// Spy guess word function
window.spyGuessWord = async (word) => {
    const snap = await get(ref(db, 'rooms/' + myRoom));
    const d = snap.val();
    
    const correct = word === d.secret;
    
    await update(ref(db, 'rooms/' + myRoom), { 
        spyGuess: word,
        status: 'result',
        winner: correct ? 'spy' : 'innocents',
        spyName: d.players[d.spyIdx]
    });
};

// Result Screen
function showResultScreen(d) {
    document.getElementById('spy-guess-screen').classList.add('hidden');
    document.getElementById('result-screen').classList.remove('hidden');
    
    const icon = document.getElementById('resultIcon');
    const title = document.getElementById('resultTitle');
    const message = document.getElementById('resultMessage');
    
    if(d.winner === 'spy') {
        icon.innerText = 'ğŸ•µï¸';
        title.innerText = 'Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø§Ù†ØªØµØ±!';
        message.innerText = `${d.spyName} Ù†Ø¬Ø­ ÙÙŠ Ø§Ù„Ù…Ù‡Ù…Ø©!`;
    } else {
        icon.innerText = 'ğŸ†';
        title.innerText = 'Ø§Ù„Ø£Ø¨Ø±ÙŠØ§Ø¡ Ø§Ù†ØªØµØ±ÙˆØ§!';
        message.innerText = `ØªÙ… ÙƒØ´Ù Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ ${d.spyName}!`;
    }
    
    document.getElementById('returnToRoomBtn').onclick = async () => {
        await update(ref(db, 'rooms/' + myRoom), { 
            status: 'waiting',
            turn: 0,
            suspects: null,
            discussionMessages: null,
            readyForVote: null,
            votes: null,
            tiedPlayers: null,
            spyGuess: null,
            winner: null,
            votedPlayer: null
        });
    };
}

// Also add this event listener for chat input
document.getElementById('discussionInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        document.getElementById('sendDiscussionBtn').click();
    }
});
}
</script>
</body>
</html>
